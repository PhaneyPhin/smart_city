(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f4aae39"],{"5a25":function(e,t,a){e.exports=a.p+"img/flag.b9225040.png"},c93e:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var i=a("a322");function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Object(i["a"])(e,t,a[t])})}return e}},f654e:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("vx-card",[i("vs-button",{attrs:{color:"primary"},on:{click:function(t){return e.addDevice()}}},[e._v("Add Device")]),i("vs-table",{attrs:{"max-items":"10",search:"",pagination:"",data:e.devices},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return e._l(a,function(t,a){return i("vs-tr",{key:a},[i("vs-td",{attrs:{data:t.device_id}},[e._v(e._s(t.device_id))]),i("vs-td",{attrs:{data:t.device_name}},[e._v(e._s(t.device_name))]),i("vs-td",{attrs:{data:t.lat}},[e._v(e._s(t.lat))]),i("vs-td",{attrs:{data:t.lon}},[e._v(e._s(t.lon))]),i("vs-td",[i("feather-icon",{staticClass:"cursor-pointer w-6 h-6 text-warning",attrs:{icon:"EditIcon",size:"small"},on:{click:function(a){return e.addConfig(t)}}})],1),i("vs-td",[i("feather-icon",{staticClass:"cursor-pointer w-6 h-6 text-warning",attrs:{icon:"EditIcon",size:"small"},on:{click:function(a){return e.edit(t)}}})],1),i("vs-td",[i("feather-icon",{staticClass:"cursor-pointer w-6 h-6 text-danger",attrs:{icon:"Trash2Icon",size:"small"},on:{click:function(a){return e.delete_device(t)}}})],1)],1)})}}])},[i("template",{slot:"thead"},[i("vs-th",{attrs:{"sort-key":"device_id"}},[e._v("device id")]),i("vs-th",{attrs:{"sort-key":"device_name"}},[e._v("device name")]),i("vs-th",[e._v("lat")]),i("vs-th",[e._v("lon")]),i("vs-th",[e._v("add config")]),i("vs-th",[e._v("edit")]),i("vs-th",[e._v("delete")])],1)],2),i("vs-popup",{staticClass:"holamundo",attrs:{title:"View Config",active:e.viewConfig},on:{"update:active":function(t){e.viewConfig=t}}},[e.configs.length>0?i("div",{staticClass:"w-full"},[e._l(e.configs,function(t,a){return i("vs-input",{key:a,staticClass:"w-full mt-10",attrs:{"label-placeholder":t.name,"val-icon-warning":"warning",name:t.name,"icon-pack":"feather",icon:"icon-user","icon-no-border":""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})}),i("div",{staticClass:"mt-10"},[i("vs-button",{ref:"loadableButton",staticClass:"vs-con-loading__container mr-5 ml-5",attrs:{id:"button-with-loading",vslor:"primary"},on:{click:function(t){return e.save_config()}}},[e._v(e._s(e.$t("save")))]),i("vs-button",{attrs:{color:"danger",type:"border"},on:{click:function(t){e.viewConfig=!1}}},[e._v(e._s(e.$t("cancel")))])],1)],2):e._e(),0==e.configs.length?i("div",{staticClass:"w-full"},[i("div",{staticClass:"align-center center"},[e._v("No config field in this device type")])]):e._e()]),i("vs-popup",{staticClass:"holamundo",attrs:{fullscreen:"",title:e.title,active:e.popupActive},on:{"update:active":function(t){e.popupActive=t}}},[i("div",{staticClass:"vx-row"},[i("div",{staticClass:"w-full md:w-1/2 mt-10 pl-5"},[i("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{warning:e.errors.has("device_name"),"warning-text":e.$t("device name is required"),"label-placeholder":e.$t("device name"),"val-icon-warning":"warning",name:"device_name","icon-pack":"feather",icon:"icon-user","icon-no-border":""},model:{value:e.editObj.device_name,callback:function(t){e.$set(e.editObj,"device_name",t)},expression:"editObj.device_name"}})],1),i("div",{staticClass:"w-1/2 md:w-1/4 mt-10 pl-5 pr-5"},[i("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{warning:e.errors.has("lat"),"warning-text":e.$t("please select location in map"),"label-placeholder":e.$t("lat"),"val-icon-warning":"warning",name:"lat","icon-pack":"feather",icon:"icon-user","icon-no-border":""},model:{value:e.editObj.lat,callback:function(t){e.$set(e.editObj,"lat",t)},expression:"editObj.lat"}})],1),i("div",{staticClass:"w-1/2 md:w-1/4 mt-10 pl-5 pr-5"},[i("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{warning:e.errors.has("lon"),"warning-text":e.$t("please select location in map"),"label-placeholder":e.$t("lon"),"val-icon-warning":"warning",name:"lon","icon-pack":"feather",icon:"icon-user","icon-no-border":""},model:{value:e.editObj.lon,callback:function(t){e.$set(e.editObj,"lon",t)},expression:"editObj.lon"}})],1)]),i("div",{staticClass:"vx-row"},[i("div",{staticClass:"vx-col w-full md:w-1/3 mt-10 mb-10"},[i("div",{staticClass:"w-full pb-5"},[i("label",{staticClass:"mt-10"},[e._v("device type")]),i("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{warning:e.errors.has("device_type"),"warning-text":e.$t("device type id is required"),"val-icon-warning":"warning",name:"device_type"},model:{value:e.editObj.device_type_id,callback:function(t){e.$set(e.editObj,"device_type_id",t)},expression:"editObj.device_type_id"}},e._l(e.device_types,function(e,t){return i("vs-select-item",{key:t,attrs:{value:e.device_type_id,text:e.device_type_name}})}),1)],1),i("label",{staticClass:"mt-10",attrs:{for:""}},[e._v(e._s(e.$t("device_icon")))]),""==e.editObj.device_icon||null==e.editObj.device_icon?i("div",{staticClass:"con-upload"},[i("div",{staticClass:"con-img-upload"},[i("div",{staticClass:"con-input-upload"},[i("input",{ref:"myFiles",attrs:{type:"file"},on:{change:e.previewFiles}}),i("span",{staticClass:"text-input"},[e._v("upload device icon")]),i("span",{staticClass:"input-progress",staticStyle:{width:"0%"}}),i("button",{staticClass:"btn-upload-all vs-upload--button-upload",attrs:{disabled:"disabled",type:"button",title:"Upload"}},[i("i",{staticClass:"material-icons notranslate",attrs:{translate:"translate"}},[e._v("cloud_upload")])])])])]):e._e(),""!=e.editObj.device_icon&&null!=e.editObj.device_icon?i("div",{staticClass:"con-upload"},[i("div",{staticClass:"con-img-upload"},[i("div",{staticClass:"img-upload"},[i("button",{staticClass:"btn-x-file",on:{click:function(t){e.editObj.device_icon=""}}},[i("i",{staticClass:"material-icons notranslate",attrs:{translate:"translate"}},[e._v("clear")])]),i("button",{staticClass:"btn-upload-file"},[i("i",{staticClass:"material-icons notranslate",attrs:{translate:"translate"}},[e._v("cloud_upload")]),i("span",[e._v("%")])]),i("img",{staticStyle:{"max-width":"none","max-height":"100%"},attrs:{src:e.editObj.device_icon}})]),i("div",{staticClass:"con-input-upload disabled-upload"},[i("input",{attrs:{type:"file",accept:"image/*",disabled:"disabled"}}),i("span",{staticClass:"text-input"},[e._v("upload profile picture")]),i("span",{staticClass:"input-progress",staticStyle:{width:"0%"}}),i("button",{staticClass:"btn-upload-all vs-upload--button-upload",attrs:{type:"button",title:"Upload"}},[i("i",{staticClass:"material-icons notranslate",attrs:{translate:"translate"}},[e._v("cloud_upload")])])])])]):e._e(),i("div",{staticClass:"mt-10"},[i("h5",[e._v("Anchor (value 0-1)")]),i("div",{staticClass:"vx-row"},[i("div",{staticClass:"w-1/2 pl-5 pr-5"},[i("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|between:0,1",expression:"'required|between:0,1'"}],staticClass:"w-full",attrs:{warning:e.errors.has("anchor_x"),"warning-text":e.$t(e.errors.first("anchor_x")),"label-placeholder":e.$t("anchor x"),"val-icon-warning":"warning",name:"anchor_x"},model:{value:e.editObj.anchor_x,callback:function(t){e.$set(e.editObj,"anchor_x",t)},expression:"editObj.anchor_x"}})],1),i("div",{staticClass:"w-1/2 pl-5 pr-5"},[i("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|between:0,1",expression:"'required|between:0,1'"}],staticClass:"w-full",attrs:{warning:e.errors.has("anchor_y"),"warning-text":e.$t(e.errors.first("anchor_y")),"label-placeholder":e.$t("anchor y"),"val-icon-warning":"warning",name:"anchor_y"},model:{value:e.editObj.anchor_y,callback:function(t){e.$set(e.editObj,"anchor_y",t)},expression:"editObj.anchor_y"}})],1),i("div",{staticClass:"w-1/2 pl-5 pr-5"},[i("label",{staticClass:"mt-10"},[e._v("size")]),i("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{warning:e.errors.has("size"),"warning-text":e.$t("size is required"),"val-icon-warning":"warning",name:"size"},model:{value:e.editObj.size,callback:function(t){e.$set(e.editObj,"size",t)},expression:"editObj.size"}},e._l(e.sizes,function(e,t){return i("vs-select-item",{key:t,attrs:{value:e,text:e}})}),1)],1)])]),i("div",{staticClass:"mt-10"},[i("vs-button",{ref:"loadableButton",staticClass:"vs-con-loading__container mr-5 ml-5",attrs:{id:"button-with-loading",vslor:"primary"},on:{click:function(t){return e.save()}}},[e._v(e._s(e.$t("save")))]),i("vs-button",{attrs:{color:"danger",type:"border"},on:{click:function(t){e.popupActive=!1}}},[e._v(e._s(e.$t("cancel")))])],1)]),i("div",{staticClass:"vx-col w-full md:w-2/3 p-5 "},[e.rendermap?i("vl-map",{ref:"map",staticStyle:{height:"700px"},attrs:{"load-tiles-while-animating":!0,"load-tiles-while-interacting":!0,"data-projection":"EPSG:4326"},on:{postcompose:e.onMapPostCompose,click:e.choose_position}},[i("vl-view",{attrs:{zoom:e.zoom,center:e.center,rotation:e.rotation},on:{"update:zoom":function(t){e.zoom=t},"update:center":function(t){e.center=t},"update:rotation":function(t){e.rotation=t}}}),i("vl-layer-tile",{attrs:{id:"osm"}},[i("vl-source-osm")],1),i("vl-layer-tile",{attrs:{id:"osm"}},[i("vl-source-osm")],1),i("vl-feature",{ref:"marker",attrs:{id:"marker",properties:{start:Date.now(),duration:1e3}},scopedSlots:e._u([{key:"default",fn:function(t){return[i("vl-geom-point",{attrs:{coordinates:""==e.editObj.lat||""==e.editObj.lon?[0,0]:[parseFloat(e.editObj.lon),parseFloat(e.editObj.lat)]}}),i("vl-style-box",[i("vl-style-icon",{attrs:{src:""==e.editObj.device_icon?a("5a25"):e.editObj.device_icon,scale:e.editObj.size?e.editObj.size:1,anchor:""==e.editObj.anchor_x||""==e.editObj.anchor_y?[.1,.95]:[e.editObj.anchor_x,e.editObj.anchor_y],size:[128,128]}})],1),t.geometry?i("vl-overlay",{attrs:{position:e.pointOnSurface(t.geometry),offset:[10,10]}}):e._e()]}}],null,!1,3833031685)})],1):e._e()],1)])])],1)},n=[],s=(a("7f7f"),a("ac6a"),a("c93e")),r=(a("96cf"),a("3040")),c=a("a322"),o=a("1298"),l=a("67cf"),d=a("7f58"),u=a("138f"),v=a("2986"),p=function(e){return 1-Math.pow(1-e,3)},f={components:{EditUser:o["a"],ChangePassword:u["a"],AddUser:d["a"]},data:function(){var e;return e={submitted:!1,popupActive:!1,viewConfig:!1,editObj:{lon:l["a"].center[0],lat:l["a"].center[1],size:1},showing_device:{},sizes:[],configs:[],rendermap:!1,devices:[],src_img:"",device_types:[],change_password:!1,roles:[]},Object(c["a"])(e,"devices",[]),Object(c["a"])(e,"addUserPopUp",!1),Object(c["a"])(e,"title","Add Device"),Object(c["a"])(e,"zoom",8),Object(c["a"])(e,"center",l["a"].center),Object(c["a"])(e,"marker_post",l["a"].center),Object(c["a"])(e,"rotation",0),Object(c["a"])(e,"geolocPosition",void 0),Object(c["a"])(e,"popupConfig",!1),e},computed:{},created:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(this.getData(),t=1;t<=40;t++)this.sizes.push(t/10);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{edit:function(e){var t=this;this.editObj=Object(s["a"])({},e),this.editObj.password="",this.title="Edit Device",this.popupActive=!0,this.$nextTick(function(){t.rendermap=!0})},delete_device:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$swal({title:this.$t("Delete this device?"),type:"warning",showCancelButton:!0,icon:"question",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("cancel"),confirmButtonText:this.$t("delete"),showLoaderOnConfirm:!0,preConfirm:function(){return l["a"].postData("device/deleteDevice",{device_id:t.device_id}).then(function(e){return e})}}).then(function(e){e.value&&(e.value.code?a.$swal(a.$t("data was deleted"),"","success").then(function(e){a.getData()}):a.$swal(e.value.message,"","error"))});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),save_config:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={},this.configs.forEach(function(e){t[e.name]=e.value}),t=JSON.stringify(t),e.prev=3,e.next=6,this.$service.postData("device/updateDeviceConfig",{device_id:this.showing_device.device_id,config:t});case 6:if(a=e.sent,1!=a.code){e.next=13;break}return this.viewConfig=!1,e.next=11,this.$swal("data was saved!","","success");case 11:e.next=16;break;case 13:return this.viewConfig=!1,e.next=16,this.$swal("",a.message,"error");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](3),console.log(e.t0);case 21:case"end":return e.stop()}},e,this,[[3,18]])}));return function(){return e.apply(this,arguments)}}(),getData:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].postData("device/getDevice",{});case 3:return t=e.sent,this.devices=t.data,e.next=7,this.$service.postData("device-type/getDeviceType",{});case 7:a=e.sent,this.device_types=a.data,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),previewFiles:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var a,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a=new FileReader,a.readAsDataURL(t.target.files[0]),a.onload=function(){i.editObj.device_icon=a.result};case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),closepopup:function(){this.popupActive=!1,this.addUserPopUp=!1,this.getData()},addDevice:function(){var e=this;this.title="Add Device",this.editObj={device_id:"",device_name:"",device_icon:"",device_type_id:"",lon:l["a"].center[0],lat:l["a"].center[1],anchor_x:.1,anchor_y:.95,size:1},this.$nextTick(function(){e.rendermap=!0}),this.popupActive=!0},choose_position:function(e){this.editObj.lon=e.coordinate[0],this.editObj.lat=e.coordinate[1]},save:function(){var e=this;this.$validator.validateAll().then(function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(a){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=14;break}if("",""!=e.editObj.device_id){t.next=8;break}return t.next=5,e.$service.postData("device/addDevice",e.editObj);case 5:a=t.sent,t.next=11;break;case 8:return t.next=10,e.$service.postData("device/updateDevice",e.editObj);case 10:a=t.sent;case 11:1==a.code?e.$swal(e.$t("data was saved!!"),"","success"):e.$vs.notify({title:"Danger",text:a.message,color:"success"}),e.popupActive=!1,e.getData();case 14:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())},addConfig:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.viewConfig=!0,this.showing_device=t,e.prev=2,e.next=5,this.$service.postData("device/getDeviceConfig",{device_id:t.device_id});case 5:a=e.sent,1==a.code?(this.configs=a.data,console.log(this.configs)):(this.viewConfig=!1,this.$swal("",a.message,"error")),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0);case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),parseFloat:parseFloat,pointOnSurface:v["A"],onMapPostCompose:function(e){var t=e.vectorContext,a=e.frameState;if(this.$refs.marker&&this.$refs.marker.$feature){var i=this.$refs.marker.$feature;if(i.getGeometry()&&i.getStyle()){var n=i.getGeometry().clone(),s=i.get("duration"),r=a.time-i.get("start"),c=r/s,o=35*p(c)+5,l=p(1-c),d=p(.5-c);t.setStyle(Object(v["x"])({imageRadius:o,fillColor:[119,170,203,d],strokeColor:[119,170,203,l],strokeWidth:2+l})),t.drawGeometry(n),t.setStyle(i.getStyle()(i)[0]),t.drawGeometry(i.getGeometry()),r>s&&i.set("start",Date.now()),this.$refs.map.render()}}}}},h=f,m=a("2877"),w=Object(m["a"])(h,i,n,!1,null,null,null);t["default"]=w.exports}}]);
//# sourceMappingURL=chunk-1f4aae39.67d33e74.js.map