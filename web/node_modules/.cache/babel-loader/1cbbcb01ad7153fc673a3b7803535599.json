{"remainingRequest":"C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\src\\views\\pages\\devices\\Device.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\src\\views\\pages\\devices\\Device.vue","mtime":1580530451489},{"path":"C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1579332194156},{"path":"C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1579332188909},{"path":"C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1579332194156},{"path":"C:\\Users\\Sovannarith Phan\\Utility_Website\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":1579332241739}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"C:\\\\Users\\\\Sovannarith Phan\\\\Utility_Website\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/objectSpread\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Sovannarith Phan\\\\Utility_Website\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/asyncToGenerator\";\nimport _defineProperty from \"C:\\\\Users\\\\Sovannarith Phan\\\\Utility_Website\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/defineProperty\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport EditUser from '../users/EditUser';\nimport service from '@/service/service';\nimport AddUser from '../users/AddUser';\nimport ChangePassword from '../users/ChangePassword';\nimport { createProj, addProj, findPointOnSurface, createStyle, createMultiPointGeom, loadingBBox } from 'vuelayers/lib/ol-ext';\n\nvar easeInOut = function easeInOut(t) {\n  return 1 - Math.pow(1 - t, 3);\n};\n\nexport default {\n  components: {\n    EditUser: EditUser,\n    ChangePassword: ChangePassword,\n    AddUser: AddUser\n  },\n  data: function data() {\n    var _ref;\n\n    return _ref = {\n      submitted: false,\n      popupActive: false,\n      viewConfig: false,\n      editObj: {\n        lon: service.center[0],\n        lat: service.center[1],\n        size: 1\n      },\n      showing_device: {},\n      sizes: [],\n      configs: [],\n      rendermap: false,\n      devices: [],\n      src_img: \"\",\n      device_types: [],\n      change_password: false,\n      roles: []\n    }, _defineProperty(_ref, \"devices\", []), _defineProperty(_ref, \"addUserPopUp\", false), _defineProperty(_ref, \"title\", \"Add Device\"), _defineProperty(_ref, \"zoom\", 8), _defineProperty(_ref, \"center\", service.center), _defineProperty(_ref, \"marker_post\", service.center), _defineProperty(_ref, \"rotation\", 0), _defineProperty(_ref, \"geolocPosition\", undefined), _defineProperty(_ref, \"popupConfig\", false), _ref;\n  },\n  computed: {},\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var i;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.getData();\n\n              for (i = 1; i <= 40; i++) {\n                this.sizes.push(i / 10);\n              }\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function created() {\n      return _created.apply(this, arguments);\n    };\n  }(),\n  methods: {\n    edit: function edit(tr) {\n      var _this = this;\n\n      this.editObj = _objectSpread({}, tr);\n      this.editObj.password = '';\n      this.title = 'Edit Device';\n      this.popupActive = true;\n      this.$nextTick(function () {\n        _this.rendermap = true;\n      });\n    },\n    delete_device: function () {\n      var _delete_device = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(tr) {\n        var _this2 = this;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.$swal({\n                  title: this.$t(\"Delete this device?\"),\n                  type: \"warning\",\n                  showCancelButton: true,\n                  icon: 'question',\n                  confirmButtonColor: \"#3085d6\",\n                  cancelButtonColor: \"#d33\",\n                  cancelButtonText: this.$t(\"cancel\"),\n                  confirmButtonText: this.$t(\"delete\"),\n                  showLoaderOnConfirm: true,\n                  preConfirm: function preConfirm() {\n                    return service.postData(\"device/deleteDevice\", {\n                      device_id: tr.device_id\n                    }).then(function (result) {\n                      return result;\n                    });\n                  }\n                }).then(function (result) {\n                  if (result.value) {\n                    if (result.value.code) {\n                      _this2.$swal(_this2.$t(\"data was deleted\"), \"\", \"success\").then(function (result) {\n                        _this2.getData();\n                      });\n                    } else {\n                      _this2.$swal(result.value.message, \"\", \"error\");\n                    }\n                  }\n                });\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function delete_device(_x) {\n        return _delete_device.apply(this, arguments);\n      };\n    }(),\n    save_config: function () {\n      var _save_config = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var obj, configRespnse;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                obj = {};\n                this.configs.forEach(function (item) {\n                  obj[item.name] = item.value;\n                });\n                obj = JSON.stringify(obj);\n                _context3.prev = 3;\n                _context3.next = 6;\n                return this.$service.postData('device/updateDeviceConfig', {\n                  device_id: this.showing_device.device_id,\n                  config: obj\n                });\n\n              case 6:\n                configRespnse = _context3.sent;\n\n                if (!(configRespnse.code == 1)) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                this.viewConfig = false;\n                _context3.next = 11;\n                return this.$swal('data was saved!', '', 'success');\n\n              case 11:\n                _context3.next = 16;\n                break;\n\n              case 13:\n                this.viewConfig = false;\n                _context3.next = 16;\n                return this.$swal('', configRespnse.message, 'error');\n\n              case 16:\n                _context3.next = 21;\n                break;\n\n              case 18:\n                _context3.prev = 18;\n                _context3.t0 = _context3[\"catch\"](3);\n                console.log(_context3.t0);\n\n              case 21:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[3, 18]]);\n      }));\n\n      return function save_config() {\n        return _save_config.apply(this, arguments);\n      };\n    }(),\n    getData: function () {\n      var _getData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4() {\n        var deviceResponse, device_typeResponse;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return service.postData(\"device/getDevice\", {});\n\n              case 3:\n                deviceResponse = _context4.sent;\n                this.devices = deviceResponse.data;\n                _context4.next = 7;\n                return this.$service.postData('device-type/getDeviceType', {});\n\n              case 7:\n                device_typeResponse = _context4.sent;\n                this.device_types = device_typeResponse.data;\n                _context4.next = 14;\n                break;\n\n              case 11:\n                _context4.prev = 11;\n                _context4.t0 = _context4[\"catch\"](0);\n                console.log(_context4.t0);\n\n              case 14:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 11]]);\n      }));\n\n      return function getData() {\n        return _getData.apply(this, arguments);\n      };\n    }(),\n    previewFiles: function () {\n      var _previewFiles = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee5(event) {\n        var _this3 = this;\n\n        var reader;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                reader = new FileReader();\n                reader.readAsDataURL(event.target.files[0]);\n\n                reader.onload = function () {\n                  _this3.editObj.device_icon = reader.result;\n                };\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      return function previewFiles(_x2) {\n        return _previewFiles.apply(this, arguments);\n      };\n    }(),\n    closepopup: function closepopup() {\n      this.popupActive = false;\n      this.addUserPopUp = false;\n      this.getData();\n    },\n    addDevice: function addDevice() {\n      var _this4 = this;\n\n      this.title = \"Add Device\";\n      this.editObj = {\n        device_id: \"\",\n        device_name: \"\",\n        device_icon: \"\",\n        device_type_id: \"\",\n        lon: service.center[0],\n        lat: service.center[1],\n        anchor_x: 0.1,\n        anchor_y: 0.95,\n        size: 1\n      };\n      this.$nextTick(function () {\n        _this4.rendermap = true;\n      });\n      this.popupActive = true;\n    },\n    choose_position: function choose_position(e) {\n      this.editObj.lon = e.coordinate[0];\n      this.editObj.lat = e.coordinate[1];\n    },\n    save: function save() {\n      var _this5 = this;\n\n      this.$validator.validateAll().then(\n      /*#__PURE__*/\n      function () {\n        var _ref2 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee6(result) {\n          var url;\n          return regeneratorRuntime.wrap(function _callee6$(_context6) {\n            while (1) {\n              switch (_context6.prev = _context6.next) {\n                case 0:\n                  if (!result) {\n                    _context6.next = 14;\n                    break;\n                  }\n\n                  url = \"\";\n\n                  if (!(_this5.editObj.device_id == \"\")) {\n                    _context6.next = 8;\n                    break;\n                  }\n\n                  _context6.next = 5;\n                  return _this5.$service.postData('device/addDevice', _this5.editObj);\n\n                case 5:\n                  result = _context6.sent;\n                  _context6.next = 11;\n                  break;\n\n                case 8:\n                  _context6.next = 10;\n                  return _this5.$service.postData('device/updateDevice', _this5.editObj);\n\n                case 10:\n                  result = _context6.sent;\n\n                case 11:\n                  if (result.code == 1) {\n                    _this5.$swal(_this5.$t('data was saved!!'), '', 'success');\n                  } else {\n                    _this5.$vs.notify({\n                      title: 'Danger',\n                      text: result.message,\n                      color: 'success'\n                    });\n                  }\n\n                  _this5.popupActive = false;\n\n                  _this5.getData();\n\n                case 14:\n                case \"end\":\n                  return _context6.stop();\n              }\n            }\n          }, _callee6, this);\n        }));\n\n        return function (_x3) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    },\n    addConfig: function () {\n      var _addConfig = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee7(tr) {\n        var configResponse;\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                this.viewConfig = true;\n                this.showing_device = tr;\n                _context7.prev = 2;\n                _context7.next = 5;\n                return this.$service.postData('device/getDeviceConfig', {\n                  device_id: tr.device_id\n                });\n\n              case 5:\n                configResponse = _context7.sent;\n\n                if (configResponse.code == 1) {\n                  this.configs = configResponse.data;\n                  console.log(this.configs);\n                } else {\n                  this.viewConfig = false;\n                  this.$swal('', configResponse.message, 'error');\n                }\n\n                _context7.next = 12;\n                break;\n\n              case 9:\n                _context7.prev = 9;\n                _context7.t0 = _context7[\"catch\"](2);\n                console.log(_context7.t0);\n\n              case 12:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this, [[2, 9]]);\n      }));\n\n      return function addConfig(_x4) {\n        return _addConfig.apply(this, arguments);\n      };\n    }(),\n    parseFloat: parseFloat,\n    pointOnSurface: findPointOnSurface,\n    onMapPostCompose: function onMapPostCompose(_ref3) {\n      var vectorContext = _ref3.vectorContext,\n          frameState = _ref3.frameState;\n      // document.querySelector('canvas').style.filter=\"invert(90%)\"\n      if (!this.$refs.marker || !this.$refs.marker.$feature) return;\n      var feature = this.$refs.marker.$feature;\n      if (!feature.getGeometry() || !feature.getStyle()) return;\n      var flashGeom = feature.getGeometry().clone();\n      var duration = feature.get('duration');\n      var elapsed = frameState.time - feature.get('start');\n      var elapsedRatio = elapsed / duration;\n      var radius = easeInOut(elapsedRatio) * 35 + 5;\n      var opacity = easeInOut(1 - elapsedRatio);\n      var fillOpacity = easeInOut(0.5 - elapsedRatio);\n      vectorContext.setStyle(createStyle({\n        imageRadius: radius,\n        fillColor: [119, 170, 203, fillOpacity],\n        strokeColor: [119, 170, 203, opacity],\n        strokeWidth: 2 + opacity\n      }));\n      vectorContext.drawGeometry(flashGeom);\n      vectorContext.setStyle(feature.getStyle()(feature)[0]);\n      vectorContext.drawGeometry(feature.getGeometry());\n\n      if (elapsed > duration) {\n        feature.set('start', Date.now());\n      }\n\n      this.$refs.map.render();\n    }\n  }\n};",{"version":3,"sources":["Device.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <vx-card>\r\n    <vs-button color=\"primary\" @click=\"addDevice()\">Add Device</vs-button>\r\n    <vs-table max-items=\"10\" search pagination :data=\"devices\">\r\n      <template slot=\"thead\">\r\n        <vs-th sort-key=\"device_id\">device id</vs-th>\r\n        <vs-th sort-key=\"device_name\">device name</vs-th>\r\n        <vs-th>lat</vs-th>\r\n        <vs-th>lon</vs-th>\r\n        <vs-th>add config</vs-th>\r\n        <vs-th>edit</vs-th>\r\n        <vs-th>delete</vs-th>\r\n      </template>\r\n\r\n      <template slot-scope=\"{data}\">\r\n        <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n          <vs-td :data=\"tr.device_id\">{{ tr.device_id }}</vs-td>\r\n\r\n          <vs-td :data=\"tr.device_name\">{{ tr.device_name }}</vs-td>\r\n          <vs-td :data=\"tr.lat\">{{ tr.lat}}</vs-td>\r\n\r\n          <vs-td :data=\"tr.lon\">{{ tr.lon }}</vs-td>\r\n          <vs-td > \r\n            <feather-icon\r\n              icon=\"EditIcon\"\r\n              class=\"cursor-pointer w-6 h-6 text-warning\"\r\n              size=\"small\"\r\n              @click=\"\r\n                        addConfig(tr)\r\n                      \"\r\n            ></feather-icon>\r\n          </vs-td>\r\n          <vs-td > \r\n            <feather-icon\r\n              icon=\"EditIcon\"\r\n              class=\"cursor-pointer w-6 h-6 text-warning\"\r\n              size=\"small\"\r\n              @click=\"\r\n                        edit(tr)\r\n                      \"\r\n            ></feather-icon>\r\n          </vs-td>\r\n          <vs-td>\r\n            <feather-icon\r\n              icon=\"Trash2Icon\"\r\n              class=\"cursor-pointer w-6 h-6 text-danger\"\r\n              size=\"small\"\r\n              @click=\"delete_device(tr)\"\r\n            ></feather-icon>\r\n          </vs-td>\r\n        </vs-tr>\r\n      </template>\r\n    </vs-table>\r\n    <vs-popup class=\"holamundo\" title=\"View Config\" :active.sync=\"viewConfig\">\r\n          <div class=\"w-full\" v-if=\"configs.length>0\">\r\n            <vs-input v-for=\"(item,index) in configs\" :key=\"index\"\r\n                :label-placeholder=\"item.name\"\r\n                val-icon-warning=\"warning\"\r\n                :name=\"item.name\"\r\n                v-model=\"item.value\"\r\n                class=\"w-full mt-10\"\r\n                icon-pack=\"feather\"\r\n                icon=\"icon-user\"\r\n                icon-no-border\r\n                />\r\n              <div class=\"mt-10\">\r\n                 <vs-button\r\n                        ref=\"loadableButton\"\r\n                        id=\"button-with-loading\"\r\n                        class=\"vs-con-loading__container mr-5 ml-5\"\r\n                        vslor=\"primary\"\r\n                        @click=\"save_config()\"\r\n                    >{{ $t(\"save\") }}</vs-button>\r\n                     <vs-button\r\n                       \r\n                        color=\"danger\"\r\n                        type=\"border\"\r\n                        @click=\"viewConfig = false\"\r\n                    >{{ $t(\"cancel\") }}</vs-button>\r\n                   \r\n                </div>\r\n          </div>\r\n          <div class=\"w-full\" v-if=\"configs.length==0\">\r\n            <div class=\"align-center center\">No config field in this device type</div>\r\n          </div>\r\n    </vs-popup>\r\n    <vs-popup class=\"holamundo\"  fullscreen :title=\"title\" :active.sync=\"popupActive\">\r\n        \r\n        <div class=\"vx-row\">\r\n        <div class='w-full md:w-1/2 mt-10 pl-5'>\r\n             <vs-input\r\n                :warning=\"errors.has('device_name')\"\r\n                :warning-text=\"$t('device name is required')\"\r\n                :label-placeholder=\"$t('device name')\"\r\n                val-icon-warning=\"warning\"\r\n                v-validate=\"'required'\"\r\n                name=\"device_name\"\r\n                v-model=\"editObj.device_name\"\r\n                class=\"w-full\"\r\n                icon-pack=\"feather\"\r\n                icon=\"icon-user\"\r\n                icon-no-border\r\n                />\r\n        </div>\r\n\r\n        <div class=\"w-1/2 md:w-1/4 mt-10 pl-5 pr-5\">\r\n            <vs-input\r\n                :warning=\"errors.has('lat')\"\r\n                :warning-text=\"$t('please select location in map')\"\r\n                :label-placeholder=\"$t('lat')\"\r\n                val-icon-warning=\"warning\"\r\n                v-validate=\"'required'\"\r\n                name=\"lat\"\r\n                v-model=\"editObj.lat\"\r\n                class=\"w-full\"\r\n                icon-pack=\"feather\"\r\n                icon=\"icon-user\"\r\n                icon-no-border\r\n                />\r\n        </div>\r\n        \r\n        <div class=\"w-1/2 md:w-1/4 mt-10 pl-5 pr-5\">\r\n             <vs-input\r\n                :warning=\"errors.has('lon')\"\r\n                :warning-text=\"$t('please select location in map')\"\r\n                :label-placeholder=\"$t('lon')\"\r\n                val-icon-warning=\"warning\"\r\n                v-validate=\"'required'\"\r\n                name=\"lon\"\r\n                v-model=\"editObj.lon\"\r\n                class=\"w-full\"\r\n                icon-pack=\"feather\"\r\n                icon=\"icon-user\"\r\n                icon-no-border\r\n                />\r\n                \r\n        </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col w-full md:w-1/3 mt-10 mb-10\">\r\n            <div class=\"w-full pb-5\">\r\n                \r\n                \r\n                        <label class=\"mt-10\">device type</label>\r\n                       <vs-select \r\n                            :warning=\"errors.has('device_type')\"\r\n                            :warning-text=\"$t('device type id is required')\"\r\n                            val-icon-warning=\"warning\"\r\n                            v-validate=\"'required'\"\r\n                            name=\"device_type\"\r\n                            class=\"w-full\" v-model=\"editObj.device_type_id\"\r\n                            >\r\n                          <vs-select-item\r\n                            :value=\"item.device_type_id\"\r\n                            :text=\"item.device_type_name\"\r\n                            :key=\"index\"\r\n                            v-for=\"(item,index) of device_types\"\r\n                          />\r\n                      </vs-select>\r\n            </div>\r\n            <label class=\"mt-10\" for>{{ $t(\"device_icon\") }}</label>\r\n            <div class=\"con-upload\" v-if=\"editObj.device_icon == '' || editObj.device_icon == null\">\r\n              <!---->\r\n              <div class=\"con-img-upload\">\r\n                <div class=\"con-input-upload\">\r\n                  <input type=\"file\" @change=\"previewFiles\" ref=\"myFiles\" />\r\n                  <span class=\"text-input\">upload device icon</span>\r\n                  <span class=\"input-progress\" style=\"width: 0%;\"></span>\r\n                  <button\r\n                    disabled=\"disabled\"\r\n                    type=\"button\"\r\n                    title=\"Upload\"\r\n                    class=\"btn-upload-all vs-upload--button-upload\"\r\n                  >\r\n                    <i translate=\"translate\" class=\"material-icons notranslate\">cloud_upload</i>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"con-upload\" v-if=\"editObj.device_icon != '' && editObj.device_icon != null\">\r\n              <div class=\"con-img-upload\">\r\n                <div class=\"img-upload\">\r\n                  <button class=\"btn-x-file\" @click=\"editObj.device_icon=''\">\r\n                    <i translate=\"translate\" class=\"material-icons notranslate\">clear</i>\r\n                  </button>\r\n                  <button class=\"btn-upload-file\">\r\n                    <i translate=\"translate\" class=\"material-icons notranslate\">cloud_upload</i>\r\n                    <span>%</span>\r\n                  </button>\r\n                  <img :src=\"editObj.device_icon\" style=\"max-width: none; max-height: 100%;\" />\r\n                  <!---->\r\n                </div>\r\n                <div class=\"con-input-upload disabled-upload\">\r\n                  <input type=\"file\" accept=\"image/*\" disabled=\"disabled\" />\r\n                  <span class=\"text-input\">upload profile picture</span>\r\n                  <span class=\"input-progress\" style=\"width: 0%;\"></span>\r\n                  <button\r\n                    type=\"button\"\r\n                    title=\"Upload\"\r\n                    class=\"btn-upload-all vs-upload--button-upload\"\r\n                  >\r\n                    <i translate=\"translate\" class=\"material-icons notranslate\">cloud_upload</i>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-10\">\r\n                <h5>Anchor (value 0-1)</h5>\r\n                <div class=\"vx-row\">\r\n                  <div class=\"w-1/2 pl-5 pr-5\">\r\n                     <vs-input\r\n                        :warning=\"errors.has('anchor_x')\"\r\n                        :warning-text=\"$t(errors.first('anchor_x'))\"\r\n                        :label-placeholder=\"$t('anchor x')\"\r\n                        val-icon-warning=\"warning\"\r\n                        v-validate=\"'required|between:0,1'\"\r\n                        name=\"anchor_x\"\r\n                        v-model=\"editObj.anchor_x\"\r\n                        class=\"w-full\"\r\n                        />\r\n                  </div>\r\n                  <div class=\"w-1/2 pl-5 pr-5\">\r\n                     <vs-input\r\n                        :warning=\"errors.has('anchor_y')\"\r\n                        :warning-text=\"$t(errors.first('anchor_y'))\"\r\n                        :label-placeholder=\"$t('anchor y')\"\r\n                        val-icon-warning=\"warning\"\r\n                        v-validate=\"'required|between:0,1'\"\r\n                        name=\"anchor_y\"\r\n                        v-model=\"editObj.anchor_y\"\r\n                        class=\"w-full\"\r\n                        />\r\n                  </div>\r\n                  <div class=\"w-1/2 pl-5 pr-5\">\r\n                        <label class=\"mt-10\">size</label>\r\n                       <vs-select \r\n                            :warning=\"errors.has('size')\"\r\n                            :warning-text=\"$t('size is required')\"\r\n                            val-icon-warning=\"warning\"\r\n                            v-validate=\"'required'\"\r\n                            name=\"size\"\r\n                            class=\"w-full\" v-model=\"editObj.size\"\r\n                            >\r\n                          <vs-select-item\r\n                            :value=\"item\"\r\n                            :text=\"item\"\r\n                            :key=\"index\"\r\n                            v-for=\"(item,index) of sizes\"\r\n                          />\r\n                      </vs-select>\r\n                  </div>\r\n                 \r\n                \r\n               \r\n                </div>\r\n            </div>\r\n            <div class=\"mt-10\">\r\n                 <vs-button\r\n                        ref=\"loadableButton\"\r\n                        id=\"button-with-loading\"\r\n                        class=\"vs-con-loading__container mr-5 ml-5\"\r\n                        vslor=\"primary\"\r\n                        @click=\"save()\"\r\n                    >{{ $t(\"save\") }}</vs-button>\r\n                     <vs-button\r\n                       \r\n                        color=\"danger\"\r\n                        type=\"border\"\r\n                        @click=\"popupActive = false\"\r\n                    >{{ $t(\"cancel\") }}</vs-button>\r\n                   \r\n                </div>\r\n          </div>\r\n          <div class=\"vx-col w-full md:w-2/3 p-5 \">\r\n            <vl-map v-if=\"rendermap\" :load-tiles-while-animating=\"true\"  ref=\"map\" :load-tiles-while-interacting=\"true\"\r\n             data-projection=\"EPSG:4326\" style=\"height: 700px\"  @postcompose=\"onMapPostCompose\" @click=\"choose_position\">\r\n                <vl-view :zoom.sync=\"zoom\" :center.sync=\"center\" :rotation.sync=\"rotation\"></vl-view>\r\n\r\n\r\n\r\n                <vl-layer-tile id=\"osm\">\r\n                    <vl-source-osm></vl-source-osm>\r\n                </vl-layer-tile>\r\n                <vl-layer-tile id=\"osm\">\r\n                    <vl-source-osm></vl-source-osm>\r\n                </vl-layer-tile>\r\n\r\n                <vl-feature id=\"marker\" ref=\"marker\" :properties=\"{ start: Date.now(), duration: 1000 }\">\r\n                    <template slot-scope=\"feature\">\r\n                    <vl-geom-point :coordinates=\"editObj.lat==''||editObj.lon==''?[0,0]:[parseFloat(editObj.lon),parseFloat(editObj.lat)]\"></vl-geom-point>\r\n                    <vl-style-box>\r\n                        <vl-style-icon :src=\"editObj.device_icon==''?require('@/assets/flag.png'):editObj.device_icon\" :scale=\"editObj.size?editObj.size:1\" :anchor=\"editObj.anchor_x==''||editObj.anchor_y==''?[0.1, 0.95]:[editObj.anchor_x,editObj.anchor_y]\" :size=\"[128, 128]\"></vl-style-icon>\r\n                    </vl-style-box>\r\n                    <!-- overlay binded to feature -->\r\n                    <vl-overlay v-if=\"feature.geometry\" :position=\"pointOnSurface(feature.geometry)\" :offset=\"[10, 10]\">\r\n                        \r\n                    </vl-overlay>\r\n                    </template>\r\n                </vl-feature>\r\n\r\n                    \r\n                </vl-map>\r\n          </div>\r\n        </div>\r\n        \r\n      </vs-popup>\r\n  </vx-card>\r\n</template>\r\n\r\n<script>\r\nimport EditUser from '../users/EditUser';\r\nimport service from '@/service/service';\r\nimport AddUser from '../users/AddUser';\r\nimport ChangePassword from '../users/ChangePassword';\r\nimport { createProj, addProj, findPointOnSurface, createStyle, createMultiPointGeom, loadingBBox } from 'vuelayers/lib/ol-ext'\r\nconst easeInOut = t => 1 - Math.pow(1 - t, 3)\r\nexport default {\r\n  components:{\r\n      EditUser,\r\n      ChangePassword,\r\n      AddUser\r\n  },\r\n  data() {\r\n    return {\r\n      submitted:false,\r\n      popupActive:false,\r\n      viewConfig:false,\r\n      editObj:{\r\n           lon:service.center[0],\r\n            lat:service.center[1],\r\n            size:1\r\n      },\r\n      showing_device:{},\r\n      sizes:[],\r\n      configs:[],\r\n      rendermap:false,\r\n      devices:[],\r\n      src_img:\"\",\r\n      device_types:[],\r\n     \r\n      change_password:false,\r\n      roles:[],\r\n      devices:[],\r\n      addUserPopUp:false,\r\n      title:\"Add Device\",\r\n       zoom: 8,\r\n        center: service.center ,\r\n        marker_post:service.center,\r\n        rotation: 0,\r\n        geolocPosition: undefined,\r\n      popupConfig:false,\r\n    };\r\n  },\r\n  computed:{\r\n    \r\n   \r\n  },\r\n  async created(){\r\n     this.getData();\r\n     for(var i=1;i<=40;i++){\r\n       this.sizes.push(i/10);\r\n     }\r\n  },\r\n  methods:{\r\n    edit(tr){\r\n      this.editObj = {...tr};\r\n      this.editObj.password='';\r\n      this.title='Edit Device'\r\n      this.popupActive = true;\r\n      this.$nextTick(()=>{\r\n        this.rendermap=true;\r\n      })\r\n    },\r\n    async delete_device(tr){\r\n      this.$swal({\r\n                title: this.$t(\"Delete this device?\"),\r\n                type: \"warning\",\r\n                showCancelButton: true,\r\n                icon:'question',\r\n                confirmButtonColor: \"#3085d6\",\r\n                cancelButtonColor: \"#d33\",\r\n                cancelButtonText: this.$t(\"cancel\"),\r\n                confirmButtonText: this.$t(\"delete\"),\r\n                showLoaderOnConfirm: true,\r\n                preConfirm: () => {\r\n                return service\r\n                    .postData(\"device/deleteDevice\", { device_id: tr.device_id })\r\n                    .then(result => {\r\n                    return result;\r\n                    });\r\n                }\r\n            }).then(result => {\r\n                if (result.value) {\r\n                if (result.value.code) {\r\n                    this.$swal(this.$t(\"data was deleted\"), \"\", \"success\").then(result => {\r\n                    this.getData();\r\n                    });\r\n                } else {\r\n                    this.$swal(result.value.message, \"\", \"error\");\r\n                }\r\n                }\r\n            });\r\n    },\r\n    async save_config(){\r\n      var obj={};\r\n      this.configs.forEach((item)=>{\r\n          obj[item.name]=item.value;\r\n      })\r\n      obj=JSON.stringify(obj);\r\n\r\n      try{\r\n        var configRespnse=await this.$service.postData('device/updateDeviceConfig',{device_id:this.showing_device.device_id,config:obj});\r\n        if(configRespnse.code==1){\r\n          \r\n          this.viewConfig=false;\r\n          await this.$swal('data was saved!','','success');\r\n\r\n        }else{\r\n          this.viewConfig=false;\r\n          await this.$swal('',configRespnse.message,'error');\r\n        }\r\n      }catch(e){\r\n        console.log(e);\r\n      }\r\n    },\r\n    async getData(){\r\n         try{\r\n            var deviceResponse=await service.postData(\"device/getDevice\",{});\r\n            this.devices=deviceResponse.data;\r\n            var device_typeResponse=await this.$service.postData('device-type/getDeviceType',{});\r\n            this.device_types=device_typeResponse.data;\r\n           \r\n      }catch(e){\r\n          console.log(e);\r\n      }\r\n    },\r\n    async previewFiles(event) {\r\n      var reader = new FileReader();\r\n      reader.readAsDataURL(event.target.files[0]);\r\n      reader.onload = () => {\r\n        this.editObj.device_icon = reader.result;\r\n      };\r\n    },\r\n    closepopup(){\r\n        this.popupActive=false;\r\n        this.addUserPopUp=false;\r\n        this.getData();\r\n    }\r\n    ,\r\n    addDevice(){\r\n        this.title=\"Add Device\";\r\n        this.editObj={\r\n           device_id:\"\",\r\n           device_name:\"\",\r\n           device_icon:\"\",\r\n           device_type_id:\"\",\r\n            lon:service.center[0],\r\n            lat:service.center[1],\r\n            anchor_x:0.1,\r\n            anchor_y:0.95,\r\n            size:1\r\n        }\r\n        this.$nextTick(()=>{\r\n            this.rendermap=true;\r\n        })\r\n        this.popupActive=true;\r\n\r\n    },\r\n    choose_position(e){\r\n        this.editObj.lon=e.coordinate[0];\r\n        this.editObj.lat=e.coordinate[1];\r\n    },\r\n    save(){\r\n        this.$validator.validateAll().then(async result => {\r\n            if(result){\r\n                var url=\"\";\r\n                if(this.editObj.device_id==\"\"){\r\n                    var result=await this.$service.postData('device/addDevice',this.editObj);\r\n                }else{\r\n                    var result=await this.$service.postData('device/updateDevice',this.editObj);\r\n                }\r\n                \r\n                if(result.code==1){\r\n                        this.$swal(this.$t('data was saved!!'),'','success');\r\n                    }  else{\r\n                        this.$vs.notify({\r\n                            title:'Danger',\r\n                            text:result.message,\r\n                            color:'success'\r\n                        })\r\n                    }   \r\n                this.popupActive=false;\r\n                this.getData();\r\n            }\r\n        });\r\n        \r\n        },\r\n        async addConfig(tr){\r\n          this.viewConfig=true;\r\n          this.showing_device=tr;\r\n          try{\r\n             var configResponse=await this.$service.postData('device/getDeviceConfig',{device_id:tr.device_id});\r\n             if(configResponse.code==1){\r\n               this.configs=configResponse.data;\r\n               console.log(this.configs);\r\n             }else{\r\n               this.viewConfig=false;\r\n               this.$swal('',configResponse.message,'error');\r\n             }\r\n          }catch(e){\r\n            console.log(e);\r\n          }\r\n        },\r\n        parseFloat:parseFloat,\r\n        pointOnSurface: findPointOnSurface,\r\n        onMapPostCompose ({ vectorContext, frameState }) {\r\n            // document.querySelector('canvas').style.filter=\"invert(90%)\"\r\n            if (!this.$refs.marker || !this.$refs.marker.$feature) return\r\n\r\n            const feature = this.$refs.marker.$feature\r\n            if (!feature.getGeometry() || !feature.getStyle()) return\r\n\r\n            const flashGeom = feature.getGeometry().clone()\r\n            const duration = feature.get('duration')\r\n            const elapsed = frameState.time - feature.get('start')\r\n            const elapsedRatio = elapsed / duration\r\n            const radius = easeInOut(elapsedRatio) * 35 + 5\r\n            const opacity = easeInOut(1 - elapsedRatio)\r\n            const fillOpacity = easeInOut(0.5 - elapsedRatio)\r\n\r\n            vectorContext.setStyle(createStyle({\r\n                imageRadius: radius,\r\n                fillColor: [119, 170, 203, fillOpacity],\r\n                strokeColor: [119, 170, 203, opacity],\r\n                strokeWidth: 2 + opacity,\r\n            }))\r\n\r\n            vectorContext.drawGeometry(flashGeom)\r\n            vectorContext.setStyle(feature.getStyle()(feature)[0])\r\n            vectorContext.drawGeometry(feature.getGeometry())\r\n\r\n            if (elapsed > duration) {\r\n                feature.set('start', Date.now())\r\n            }\r\n\r\n       this.$refs.map.render()\r\n    },\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>"],"sourceRoot":"src/views/pages/devices"}]}