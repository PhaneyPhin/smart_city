{"remainingRequest":"D:\\DTC PROJECT\\booking\\web\\node_modules\\thread-loader\\dist\\cjs.js!D:\\DTC PROJECT\\booking\\web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DTC PROJECT\\booking\\web\\src\\views\\book_room.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DTC PROJECT\\booking\\web\\src\\views\\book_room.vue","mtime":1578885705474},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\DTC PROJECT\\\\booking\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Datepicker from \"vuejs-datepicker\";\nimport service from \"@/service/service\"; // import ViewData from './view/ViewData.vue';\n\nimport moment from \"moment\"; // import firebase from 'firebase/app'ว\n// import * as firebase from 'firebase/app';\n\nimport flatPickr from \"vue-flatpickr-component\";\nimport \"flatpickr/dist/flatpickr.css\";\nimport { async } from \"q\"; // import '@firebase/messaging';\n\nexport default {\n  components: {\n    Datepicker: Datepicker,\n    flatPickr: flatPickr\n  },\n  data: function data() {\n    return {\n      submitted: false,\n      renderComponent: true,\n      editObj: {},\n      booking: false,\n      detail: \"\",\n      buildings: [],\n      important: \"\",\n      remark: \"\",\n      tel: \"\",\n      member: \"\",\n      searched: false,\n      rooms: [],\n      materials: [],\n      booking_data: {},\n      material: {},\n      material_lists: [],\n      configdateTimePicker: {\n        enableTime: false,\n        enableSeconds: false,\n        noCalendar: false\n      },\n      configTime: {\n        enableTime: true,\n        enableSeconds: true,\n        noCalendar: true\n      },\n      room_lists: [],\n      important_lists: [\"normal\", \"important\"]\n    };\n  },\n  computed: {\n    body: function body() {\n      return {\n        room_id: this.editObj.room_id,\n        start_date: this.editObj.date + \" \" + this.editObj.start_time,\n        end_date: this.editObj.date + \" \" + this.editObj.end_time,\n        building_id: this.editObj.building_id\n      };\n    }\n  },\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var result;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.material = {\n                material_id: \"\",\n                material_number: \"\"\n              };\n              this.initVal();\n              _context.prev = 2;\n              _context.next = 5;\n              return service.postData(\"material/get\", {});\n\n            case 5:\n              result = _context.sent;\n              this.materials = result.data;\n              _context.next = 9;\n              return service.postData(\"building/getBuilding\", {});\n\n            case 9:\n              result = _context.sent;\n              this.buildings = result.data;\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](2);\n              this.$swal(this.$t(\"error\"), _context.t0.message, \"error\");\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[2, 13]]);\n    }));\n\n    return function created() {\n      return _created.apply(this, arguments);\n    };\n  }(),\n  methods: {\n    checkNumber: function checkNumber(e) {\n      var checkNumber = window.checkNumber(e);\n\n      if (!checkNumber) {\n        e.preventDefault();\n      }\n    },\n    initVal: function () {\n      var _initVal = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.editObj = {\n                  building_id: \"\",\n                  room_id: \"\",\n                  date: moment().format(\"YYYY-MM-DD\"),\n                  start_time: moment().format(\"HH:mm:ss\"),\n                  end_time: \"17:30:00\"\n                };\n                this.booking = false;\n                this.detail = \"\";\n                this.buildings = [];\n                this.important = \"\";\n                this.remark = \"\";\n                this.tel = \"\";\n                this.member = \"\";\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function initVal() {\n        return _initVal.apply(this, arguments);\n      };\n    }(),\n    search: function search() {\n      var _this = this;\n\n      this.searched = true;\n      console.log(\"searching\");\n\n      if (!moment(this.body.start_date).isBefore(moment(this.body.end_date))) {\n        this.$swal(this.$t(\"start_date_canot_more_than_end_date\"), \"\", \"error\");\n      } else {\n        this.$vs.loading({\n          background: this.backgroundLoading,\n          color: this.colorLoading,\n          container: \"#button-with-loading\",\n          scale: 0.45\n        });\n        service.postData(\"get_room_with_status\", this.body).then(function (result) {\n          _this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\");\n\n          _this.room_lists = result.data;\n        }, function (err) {\n          _this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\");\n        });\n      }\n    },\n    add: function add() {\n      this.material_lists.push({\n        material_id: \"\",\n        material_number: \"\"\n      });\n    },\n    book: function book(item) {\n      this.booking = true;\n      var _service$getUser$user = service.getUser().user,\n          username = _service$getUser$user.username,\n          first_name = _service$getUser$user.first_name,\n          last_name = _service$getUser$user.last_name,\n          email = _service$getUser$user.email;\n      this.booking_data = {\n        room_id: item.room_id,\n        start_date: this.body.start_date,\n        end_date: this.body.end_date,\n        username: username,\n        first_name: first_name,\n        last_name: last_name,\n        room_name: item.room_name,\n        email: email\n      };\n    },\n    checkMaterial: function checkMaterial() {\n      var x = this.material_lists.filter(function (item) {\n        return item.material_id == \"\" || item.material_number == \"\";\n      });\n      console.log(x);\n      return x.length == 0;\n    },\n    save: function save() {\n      var _this2 = this;\n\n      this.submitted = true;\n      var result = [];\n\n      if (this.detail != \"\" && this.important != \"\" && this.member != \"\" && this.remark != \"\" && this.tel != \"\" && this.checkMaterial()) {\n        var materials = this.material_lists.map(function (item) {\n          return item;\n        });\n        materials.filter(function (item) {\n          return item.material_number != \"\";\n        }).reduce(function (res, value) {\n          if (!res[value.material_id]) {\n            res[value.material_id] = {\n              Id: value.material_id,\n              material_number: 0\n            };\n            result.push(res[value.material_id]);\n          }\n\n          res[value.material_id].material_number = parseInt(res[value.material_id].material_number) + parseInt(value.material_number);\n          return res;\n        }, {});\n        var material_lists = result.filter(function (item) {\n          return item.material_number > 0;\n        });\n        this.$swal({\n          title: this.$t(\"booking_room_title\"),\n          type: \"warning\",\n          showCancelButton: true,\n          confirmButtonColor: \"#3085d6\",\n          cancelButtonColor: \"#d33\",\n          cancelButtonText: this.$t(\"cancel\"),\n          confirmButtonText: this.$t(\"book\"),\n          showLoaderOnConfirm: true,\n          preConfirm: function preConfirm() {\n            var _this2$booking_data = _this2.booking_data,\n                username = _this2$booking_data.username,\n                room_id = _this2$booking_data.room_id,\n                start_date = _this2$booking_data.start_date,\n                end_date = _this2$booking_data.end_date;\n            return service.postData(\"/booking_room\", {\n              booking_description: _this2.detail,\n              username: username,\n              room_id: room_id,\n              start_date: start_date,\n              end_date: end_date,\n              material_lists: material_lists,\n              important: _this2.important,\n              member: _this2.member,\n              remark: _this2.remark,\n              tel: _this2.tel\n            }).then(function (result) {\n              return result;\n            });\n          }\n        }).then(function (result) {\n          if (result.value) {\n            if (result.value.code) {\n              _this2.$swal(_this2.$t(\"success_title\"), \"\", \"success\").then(function (result) {\n                _this2.booking = false;\n                service.postData(\"get_room_with_status\", _this2.body).then(function (result) {\n                  // this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\n                  _this2.room_lists = result.data;\n                  _this2.material_lists = [];\n                  _this2.detail = \"\";\n                  _this2.important = \"\";\n                  _this2.submitted = false;\n\n                  _this2.initVal();\n                }, function (err) {// this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\n                });\n              });\n            } else {\n              _this2.$swal(_this2.$t(\"error\"), result.value.message, \"error\");\n            }\n          }\n        });\n      }\n    }\n  },\n  watch: {\n    \"editObj.building_id\": function () {\n      var _editObjBuilding_id = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3(val) {\n        var result;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this.editObj.room_id = \"\";\n                _context3.next = 3;\n                return service.postData(\"getRoomByBuilding\", {\n                  building_id: this.editObj.building_id\n                });\n\n              case 3:\n                result = _context3.sent;\n                this.rooms = result.data;\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function editObjBuilding_id(_x) {\n        return _editObjBuilding_id.apply(this, arguments);\n      };\n    }()\n  }\n};",{"version":3,"sources":["book_room.vue"],"names":[],"mappings":"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","sourcesContent":["<template >\r\n  <div class=\"vx-col w-full mb-base\" v-if=\"renderComponent\">\r\n    <div class=\"w-full\" v-if=\"!booking\">\r\n      <vx-card>\r\n        <h6>{{$t(\"search_free_room\")}}</h6>\r\n        <div class=\"vx-row\">\r\n          <div class=\"vx-col md:w-1/3 sm:w-1/2 w-full mt-6\">\r\n            <label>{{$t(\"Building\")}}</label>\r\n            <vs-select class=\"w-full\" v-model=\"editObj.building_id\">\r\n              <vs-select-item value :text=\"$t('all')\" />\r\n              <vs-select-item\r\n                :key=\"index\"\r\n                :value=\"item.building_id\"\r\n                :text=\"$t(item.building_name)\"\r\n                v-for=\"(item,index) in buildings\"\r\n              />\r\n            </vs-select>\r\n          </div>\r\n          <div class=\"vx-col md:w-1/3 sm:w-1/2 w-full mt-6\">\r\n            <label>{{$t(\"room\")}}</label>\r\n            <vs-select class=\"w-full\" v-model=\"editObj.room_id\">\r\n              <vs-select-item value :text=\"$t('all')\" />\r\n              <vs-select-item\r\n                :key=\"index\"\r\n                :value=\"item.room_id\"\r\n                :text=\"$t(item.room_name)\"\r\n                v-for=\"(item,index) in rooms\"\r\n              />\r\n            </vs-select>\r\n          </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n          <div class=\"vx-col md:w-1/3 sm:w-1/2 w-full mt-6\">\r\n            <label>{{$t(\"date\")}}</label>\r\n            <flat-pickr\r\n              :config=\"configdateTimePicker\"\r\n              class=\"w-full\"\r\n              v-model=\"editObj.date\"\r\n              placeholder=\"Choose time\"\r\n            />\r\n          </div>\r\n\r\n          <div class=\"vx-col md:w-1/3 sm:w-1/2 w-full mt-6\">\r\n            <div style=\"width:45%;float:left\">\r\n              <label>{{$t(\"time\")}}</label>\r\n              <flat-pickr\r\n                :config=\"configTime\"\r\n                class=\"w-full\"\r\n                v-model=\"editObj.start_time\"\r\n                placeholder=\"Choose time\"\r\n              />\r\n            </div>\r\n\r\n            <div style=\"width:10%;float:left;text-align:center;padding-top:30px\">{{$t('to')}}</div>\r\n            <div style=\"width:45%;padding-top:20px;float:left\">\r\n              <flat-pickr\r\n                :config=\"configTime\"\r\n                class=\"w-full\"\r\n                v-model=\"editObj.end_time\"\r\n                placeholder=\"Choose time\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div class=\"vx-col md:w-1/6 sm:w-1/2 w-full mt-6\" style=\"padding-top:20px;\">\r\n            <vs-button\r\n              ref=\"loadableButton\"\r\n              id=\"button-with-loading\"\r\n              class=\"vs-con-loading__container right\"\r\n              vslor=\"primary\"\r\n              @click=\"search()\"\r\n            >{{$t('search')}}</vs-button>\r\n          </div>\r\n        </div>\r\n      </vx-card>\r\n      <div class=\"mt-6 text-center\" v-if=\"room_lists.length==0&&searched\">{{$t(\"no_data\")}}</div>\r\n      <div class=\"vx-row\">\r\n        <div\r\n          v-for=\"(item,index) in room_lists\"\r\n          :key=\"index\"\r\n          class=\"vx-col lg:w-1/3 md:w-1/2 w-full mt-5\"\r\n          style=\"padding:10px\"\r\n        >\r\n          <vx-card class=\"w-full\">\r\n            <table style=\"width:100%\">\r\n              <tr>\r\n                <td>{{$t(\"room_id\")}}</td>\r\n                <td>{{item.room_id}}</td>\r\n              </tr>\r\n              <tr>\r\n                <td>{{$t(\"room_name\")}}</td>\r\n                <td>{{item.room_name}}</td>\r\n              </tr>\r\n              <tr>\r\n                <td>{{$t(\"num_table\")}}</td>\r\n                <td>{{item.num_table}}</td>\r\n              </tr>\r\n              <tr>\r\n                <td>{{$t(\"num_chair\")}}</td>\r\n                <td>{{item.num_chair}}</td>\r\n              </tr>\r\n              <tr>\r\n                <td>{{$t(\"status\")}}</td>\r\n                <td\r\n                  :style=\"{color:item.status=='1'?'green':'red'}\"\r\n                >{{item.status=='1'?$t('Available'):$t('Not Available')}}</td>\r\n              </tr>\r\n              <tr>\r\n                <td colspan=\"2\">\r\n                  <vs-button\r\n                    ref=\"loadableButton\"\r\n                    id=\"button-with-loading1\"\r\n                    class=\"vs-con-loading__container\"\r\n                    vslor=\"primary\"\r\n                    @click=\"book(item)\"\r\n                    :disabled=\"item.status=='0'\"\r\n                  >{{$t('book_this_room')}}</vs-button>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </vx-card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"w-full\" v-if=\"booking\">\r\n      <vx-card>\r\n        <div class=\"vx-row\">\r\n          <div class=\"vx-col full\">\r\n            <h6>{{$t('booking_room')}}</h6>\r\n          </div>\r\n        </div>\r\n        <div class=\"mt-6 vx-row lg:ml-10 lg:mr-10\">\r\n          <div class=\"vx-col lg:w-1/2 w-full\">\r\n            <table style=\"width:100%\">\r\n              <tr>\r\n                <td style=\"padding:5px\">{{$t(\"username\")}}</td>\r\n                <td class=\"text-primary\">{{booking_data.first_name+' '+booking_data.last_name}}</td>\r\n              </tr>\r\n              <tr></tr>\r\n              <tr style>\r\n                <td style=\"padding:5px\">{{$t('start_date')}}</td>\r\n                <td class=\"text-primary\">{{booking_data.start_date}}</td>\r\n              </tr>\r\n              <tr style>\r\n                <td style=\"padding:5px\">{{$t('email')}}</td>\r\n                <td class=\"text-primary\">{{booking_data.email}}</td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n          <div class=\"vx-col lg:w-1/2 w-full\">\r\n            <table style=\"width:100%\">\r\n              <tr>\r\n                <td>{{$t(\"room_name\")}}</td>\r\n                <td class=\"text-primary\">{{booking_data.room_name}}</td>\r\n              </tr>\r\n              <tr></tr>\r\n              <tr>\r\n                <td>{{$t('end_date')}}</td>\r\n                <td class=\"text-primary\">{{booking_data.end_date}}</td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <vs-divider position=\"left\">{{$t(\"detail_input\")}}</vs-divider>\r\n        <div class=\"container\">\r\n          <div class=\"vx-row mt-10\">\r\n            <div class=\"vx-col md:w-1/4 sm:w-1/3 w-full\">\r\n              {{$t(\"detail\")}}\r\n              <span class=\"require\">*</span>:\r\n            </div>\r\n            <div class=\"vx-col md:w-3/4 sm:w-2/3 w-full\">\r\n              <vs-input class=\"w-full\" v-model=\"detail\" :danger=\"submitted&&detail==''\" />\r\n              <div class=\"errors\" v-if=\"submitted&&detail==''\">{{$t(\"Please input subject\")}}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"vx-row mt-5 mb-10\">\r\n            <div class=\"vx-col md:w-1/4 sm:w-1/3 w-full\">\r\n              {{$t(\"importance\")}} :\r\n              <span class=\"require\">*</span>\r\n            </div>\r\n            <div class=\"vx-col md:w-3/4 sm:w-2/3 w-full\">\r\n              <vs-select class=\"w-full\" v-model=\"important\" :danger=\"important==''&&submitted\">\r\n                <vs-select-item\r\n                  :key=\"index\"\r\n                  :value=\"item\"\r\n                  :text=\"$t(item)\"\r\n                  v-for=\"(item,index) in important_lists\"\r\n                />\r\n              </vs-select>\r\n\r\n              <div class=\"errors\" v-if=\"submitted&&important==''\">{{$t(\"Please select important\")}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"vx-row mt-5 mb-10\">\r\n            <div class=\"vx-col md:w-1/4 sm:w-1/3 w-full\">\r\n              {{$t(\"Number of Member\")}} :\r\n              <span class=\"require\">*</span>\r\n            </div>\r\n            <div class=\"vx-col md:w-3/4 sm:w-2/3 w-full\">\r\n              <vs-input\r\n                class=\"w-full\"\r\n                v-model=\"member\"\r\n                :danger=\"submitted&&member==''\"\r\n                @keypress=\"checkNumber\"\r\n              />\r\n              <div\r\n                class=\"errors\"\r\n                v-if=\"submitted&&member==''\"\r\n              >{{$t(\"Please input number of member\")}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"vx-row mt-5 mb-10\">\r\n            <div class=\"vx-col md:w-1/4 sm:w-1/3 w-full\">\r\n              {{$t(\"Remark\")}} :\r\n              <span class=\"require\">*</span>\r\n            </div>\r\n            <div class=\"vx-col md:w-3/4 sm:w-2/3 w-full\">\r\n              <vs-input class=\"w-full\" v-model=\"remark\" :danger=\"submitted&&remark==''\" />\r\n              <div class=\"errors\" v-if=\"submitted&&remark==''\">{{$t(\"Please input remark\")}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"vx-row mt-5 mb-10\">\r\n            <div class=\"vx-col md:w-1/4 sm:w-1/3 w-full\">\r\n              {{$t(\"Tel\")}} :\r\n              <span class=\"require\">*</span>\r\n            </div>\r\n            <div class=\"vx-col md:w-3/4 sm:w-2/3 w-full\">\r\n              <vs-input\r\n                class=\"w-full\"\r\n                v-model=\"tel\"\r\n                :danger=\"submitted&&tel==''\"\r\n                maxlength=\"10\"\r\n                @keypress=\"checkNumber\"\r\n              />\r\n              <div class=\"errors\" v-if=\"submitted&&tel==''\">{{$t(\"Please input remark\")}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <vs-divider position=\"left\">{{$t(\"material_using\")}}</vs-divider>\r\n        <div class=\"container\">\r\n          <div class=\"vx-row\">\r\n            <div class=\"vx-col w-full mt-5\">\r\n              <vs-button\r\n                color=\"primary\"\r\n                icon-pack=\"feather\"\r\n                icon=\"icon-plus\"\r\n                @click=\"add()\"\r\n              >{{$t('add')}}</vs-button>\r\n            </div>\r\n          </div>\r\n          <div class=\"vx-row\" v-for=\"(item,index) in material_lists\" :key=\"index\">\r\n            <div class=\"vx-col md:w-1/3 sm:w-1/2 w-full mt-5\">\r\n              {{$t(\"material\")}} ({{$t('material_price')}})\r\n              <vs-select\r\n                class=\"w-full\"\r\n                v-model=\"item.material_id\"\r\n                :danger=\"item.material_id==''&&submitted\"\r\n              >\r\n                <vs-select-item\r\n                  :key=\"index\"\r\n                  :value=\"material.material_id\"\r\n                  :text=\"$t(material.material_name+' ('+material.material_price+')')\"\r\n                  v-for=\"(material,index) in materials\"\r\n                />\r\n              </vs-select>\r\n              <div\r\n                class=\"errors\"\r\n                v-if=\"item.material_id==''&&submitted\"\r\n              >{{$t('please select material')}}</div>\r\n            </div>\r\n            <div class=\"vx-col md:w-1/3 sm:w-1/2 w-full mt-5\">\r\n              {{$t(\"material_number\")}}\r\n              <vs-input\r\n                class=\"w-full\"\r\n                v-model=\"item.material_number\"\r\n                @keypress=\"checkNumber\"\r\n                :danger=\"item.material_number==''&&submitted\"\r\n              />\r\n              <div\r\n                class=\"errors\"\r\n                v-if=\"item.material_number==''&&submitted\"\r\n              >{{$t('please input the number of material')}}</div>\r\n            </div>\r\n            <div class=\"vx-col md:w-1/3 sm:w-1/2 w-full mt-10\">\r\n              <vs-button\r\n                ref=\"loadableButton\"\r\n                color=\"danger\"\r\n                @click=\"material_lists.splice(index,1)\"\r\n              >{{$t('remove')}}</vs-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"container\">\r\n          <div class=\"vx-row mt-10\">\r\n            <div class=\"w-full\">\r\n              <vs-button class=\"mr-4\" @click=\"save()\">{{$t('save')}}</vs-button>\r\n              <vs-button\r\n                color=\"danger\"\r\n                type=\"border\"\r\n                @click=\"booking=false;booking_data={}\"\r\n              >{{$t('cancel')}}</vs-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </vx-card>\r\n    </div>\r\n  </div>\r\n  <!-- <button>click</button> -->\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n.right {\r\n  float: right;\r\n  margin-right: 10px;\r\n}\r\n.require {\r\n  color: red;\r\n}\r\n\r\n.danger input {\r\n  padding: 0.7rem;\r\n  font-size: 1rem;\r\n  border-radius: 5px;\r\n  border: 1px solid red;\r\n  color: #626262;\r\n  width: 100%;\r\n}\r\n.error {\r\n  color: red;\r\n  font-size: 80%;\r\n}\r\ntd {\r\n  width: 50%;\r\n  padding: 10px;\r\n}\r\n</style>\r\n\r\n\r\n<script>\r\nimport Datepicker from \"vuejs-datepicker\";\r\nimport service from \"@/service/service\";\r\n// import ViewData from './view/ViewData.vue';\r\nimport moment from \"moment\";\r\n// import firebase from 'firebase/app'ว\r\n// import * as firebase from 'firebase/app';\r\nimport flatPickr from \"vue-flatpickr-component\";\r\nimport \"flatpickr/dist/flatpickr.css\";\r\nimport { async } from \"q\";\r\n// import '@firebase/messaging';\r\nexport default {\r\n  components: {\r\n    Datepicker,\r\n    flatPickr\r\n  },\r\n  data() {\r\n    return {\r\n      submitted: false,\r\n      renderComponent: true,\r\n      editObj: {},\r\n      booking: false,\r\n      detail: \"\",\r\n      buildings: [],\r\n      important: \"\",\r\n      remark: \"\",\r\n      tel: \"\",\r\n      member: \"\",\r\n      searched: false,\r\n      rooms: [],\r\n      materials: [],\r\n      booking_data: {},\r\n      material: {},\r\n      material_lists: [],\r\n      configdateTimePicker: {\r\n        enableTime: false,\r\n        enableSeconds: false,\r\n        noCalendar: false\r\n      },\r\n      configTime: {\r\n        enableTime: true,\r\n        enableSeconds: true,\r\n        noCalendar: true\r\n      },\r\n      room_lists: [],\r\n      important_lists: [\"normal\", \"important\"]\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    body() {\r\n      return {\r\n        room_id: this.editObj.room_id,\r\n        start_date: this.editObj.date + \" \" + this.editObj.start_time,\r\n        end_date: this.editObj.date + \" \" + this.editObj.end_time,\r\n        building_id: this.editObj.building_id\r\n      };\r\n    }\r\n  },\r\n  async created() {\r\n    this.material = { material_id: \"\", material_number: \"\" };\r\n    this.initVal();\r\n\r\n    try {\r\n      var result = await service.postData(\"material/get\", {});\r\n\r\n      this.materials = result.data;\r\n\r\n      result = await service.postData(\"building/getBuilding\", {});\r\n      this.buildings = result.data;\r\n    } catch (e) {\r\n      this.$swal(this.$t(\"error\"), e.message, \"error\");\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    checkNumber(e) {\r\n      var checkNumber = window.checkNumber(e);\r\n      if (!checkNumber) {\r\n        e.preventDefault();\r\n      }\r\n    },\r\n    async initVal() {\r\n      this.editObj = {\r\n        building_id: \"\",\r\n        room_id: \"\",\r\n        date: moment().format(\"YYYY-MM-DD\"),\r\n        start_time: moment().format(\"HH:mm:ss\"),\r\n        end_time: \"17:30:00\"\r\n      };\r\n      this.booking = false;\r\n      this.detail = \"\";\r\n      this.buildings = [];\r\n      this.important = \"\";\r\n      this.remark = \"\";\r\n      this.tel = \"\";\r\n      this.member = \"\";\r\n    },\r\n    search() {\r\n      this.searched = true;\r\n      console.log(\"searching\");\r\n\r\n      if (!moment(this.body.start_date).isBefore(moment(this.body.end_date))) {\r\n        this.$swal(this.$t(\"start_date_canot_more_than_end_date\"), \"\", \"error\");\r\n      } else {\r\n        this.$vs.loading({\r\n          background: this.backgroundLoading,\r\n          color: this.colorLoading,\r\n          container: \"#button-with-loading\",\r\n          scale: 0.45\r\n        });\r\n        service.postData(\"get_room_with_status\", this.body).then(\r\n          result => {\r\n            this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\");\r\n            this.room_lists = result.data;\r\n          },\r\n          err => {\r\n            this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\");\r\n          }\r\n        );\r\n      }\r\n    },\r\n    add() {\r\n      this.material_lists.push({ material_id: \"\", material_number: \"\" });\r\n    },\r\n    book(item) {\r\n      this.booking = true;\r\n      var { username, first_name, last_name, email } = service.getUser().user;\r\n      this.booking_data = {\r\n        room_id: item.room_id,\r\n        start_date: this.body.start_date,\r\n        end_date: this.body.end_date,\r\n        username: username,\r\n        first_name: first_name,\r\n        last_name: last_name,\r\n        room_name: item.room_name,\r\n        email: email\r\n      };\r\n    },\r\n    checkMaterial() {\r\n      var x = this.material_lists.filter(item => {\r\n        return item.material_id == \"\" || item.material_number == \"\";\r\n      });\r\n      console.log(x);\r\n      return x.length == 0;\r\n    },\r\n    save() {\r\n      this.submitted = true;\r\n      var result = [];\r\n\r\n      if (\r\n        this.detail != \"\" &&\r\n        this.important != \"\" &&\r\n        this.member != \"\" &&\r\n        this.remark != \"\" &&\r\n        this.tel != \"\" &&\r\n        this.checkMaterial()\r\n      ) {\r\n        var materials = this.material_lists.map(item => item);\r\n        materials\r\n          .filter(item => item.material_number != \"\")\r\n          .reduce(function(res, value) {\r\n            if (!res[value.material_id]) {\r\n              res[value.material_id] = {\r\n                Id: value.material_id,\r\n                material_number: 0\r\n              };\r\n              result.push(res[value.material_id]);\r\n            }\r\n            res[value.material_id].material_number =\r\n              parseInt(res[value.material_id].material_number) +\r\n              parseInt(value.material_number);\r\n            return res;\r\n          }, {});\r\n        var material_lists = result.filter(item => item.material_number > 0);\r\n        this.$swal({\r\n          title: this.$t(\"booking_room_title\"),\r\n          type: \"warning\",\r\n          showCancelButton: true,\r\n          confirmButtonColor: \"#3085d6\",\r\n          cancelButtonColor: \"#d33\",\r\n          cancelButtonText: this.$t(\"cancel\"),\r\n          confirmButtonText: this.$t(\"book\"),\r\n          showLoaderOnConfirm: true,\r\n          preConfirm: () => {\r\n            var { username, room_id, start_date, end_date } = this.booking_data;\r\n            return service\r\n              .postData(\"/booking_room\", {\r\n                booking_description: this.detail,\r\n                username,\r\n                room_id,\r\n                start_date,\r\n                end_date,\r\n                material_lists,\r\n                important: this.important,\r\n                member: this.member,\r\n                remark: this.remark,\r\n                tel: this.tel\r\n              })\r\n              .then(result => {\r\n                return result;\r\n              });\r\n          }\r\n        }).then(result => {\r\n          if (result.value) {\r\n            if (result.value.code) {\r\n              this.$swal(this.$t(\"success_title\"), \"\", \"success\").then(\r\n                result => {\r\n                  this.booking = false;\r\n                  service.postData(\"get_room_with_status\", this.body).then(\r\n                    result => {\r\n                      // this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                      this.room_lists = result.data;\r\n                      this.material_lists = [];\r\n                      this.detail = \"\";\r\n                      this.important = \"\";\r\n                      this.submitted = false;\r\n                      this.initVal();\r\n                    },\r\n                    err => {\r\n                      // this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                    }\r\n                  );\r\n                }\r\n              );\r\n            } else {\r\n              this.$swal(this.$t(\"error\"), result.value.message, \"error\");\r\n            }\r\n          }\r\n        });\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    async \"editObj.building_id\"(val) {\r\n      this.editObj.room_id = \"\";\r\n      var result = await service.postData(\"getRoomByBuilding\", {\r\n        building_id: this.editObj.building_id\r\n      });\r\n      this.rooms = result.data;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n"],"sourceRoot":"src/views"}]}