{"remainingRequest":"D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DTC PROJECT\\booking\\web\\src\\views\\Cost.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DTC PROJECT\\booking\\web\\src\\views\\Cost.vue","mtime":1578885477196},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport VueApexCharts from \"vue-apexcharts\";\r\nimport VuePerfectScrollbar from \"vue-perfect-scrollbar\";\r\nimport service from \"@/service/service\";\r\nimport flatPickr from \"vue-flatpickr-component\";\r\nimport \"flatpickr/dist/flatpickr.css\";\r\nimport { async } from \"q\";\r\nimport { departmentColors } from \"./Colors\";\r\nconst colors = [\r\n  \"#242145\",\r\n  \"#03a9f4\",\r\n  \"#b2b63d\",\r\n  \"#ffeb3b\",\r\n  \"#795548\",\r\n  \"#46c93a\",\r\n  \"#1f74ff\",\r\n  \"#ff4757\",\r\n  \"#ffba00\",\r\n  \"#1e1e1e\",\r\n  \"#5b3dc3\",\r\n  \"#17c964\",\r\n  \"#f2135d\",\r\n  \"#ff8200\"\r\n];\r\n\r\nexport default {\r\n  components: {\r\n    VueApexCharts,\r\n    VuePerfectScrollbar,\r\n    flatPickr\r\n  },\r\n  data() {\r\n    return {\r\n      department_id: \"\",\r\n      departmentView: 0,\r\n      popupActive: false,\r\n      selected: {},\r\n      material1: [],\r\n      materials: [],\r\n      deparment: {},\r\n      bookings: [],\r\n      view: {},\r\n      show_detail: false,\r\n      mode: 1,\r\n      sub_department: {},\r\n      departmentColors: departmentColors,\r\n      colors: colors,\r\n      renderDepartment_chart: false,\r\n      settings: {\r\n        // perfectscrollbar settings\r\n        maxScrollbarLength: 60,\r\n        wheelSpeed: 0.6\r\n      },\r\n      configdateTimePicker: {\r\n        enableTime: false,\r\n        enableSeconds: false,\r\n        noCalendar: false\r\n      },\r\n      editObj: {\r\n        start_date: \"\",\r\n        end_date: \"\"\r\n      },\r\n      DepartmentPie: {\r\n        analyticsData: [],\r\n        series: [],\r\n        chartOptions: {\r\n          labels: [],\r\n          dataLabels: {\r\n            enabled: false\r\n          },\r\n          legend: { show: false },\r\n          chart: {\r\n            type: \"pie\",\r\n            offsetY: 30,\r\n            dropShadow: {\r\n              enabled: false,\r\n              blur: 5,\r\n              left: 1,\r\n              top: 1,\r\n              opacity: 0.2\r\n            },\r\n            toolbar: {\r\n              show: false\r\n            }\r\n          },\r\n          stroke: {\r\n            width: 5\r\n          },\r\n          colors: colors\r\n        }\r\n      },\r\n      listDepartments: []\r\n    };\r\n  },\r\n  computed: {\r\n    invalid() {\r\n      var require = type => this.submitted && this.editObj[type] == \"\";\r\n      return {\r\n        start_date: require(\"start_date\"),\r\n        end_date: require(\"end_date\")\r\n      };\r\n    },\r\n    isInvald() {\r\n      return this.invalid.start_date || this.invalid.end_date;\r\n    },\r\n    isSelected() {\r\n      return JSON.stringify(this.selected) == \"{}\";\r\n    }\r\n  },\r\n\r\n  async mounted() {\r\n    this.$refs.chatLogPS.$el.scrollTop = 0;\r\n    this.search();\r\n  },\r\n  methods: {\r\n    views(tr) {\r\n      this.popupActive = true;\r\n      this.view = tr;\r\n      service\r\n        .postData(\"/get_booked_material\", { booking_id: tr.booking_id })\r\n        .then(result => {\r\n          this.material1 = result.data;\r\n        });\r\n    },\r\n    async viewSubDepartment(sub_department) {\r\n      const response = await service.postData(\"getMaterialOfficerUsing\", {\r\n        ...this.editObj,\r\n        sub_departmentView: 1,\r\n        sub_department_id: sub_department.sub_department_id\r\n      });\r\n      this.departmentView = 0;\r\n      this.sub_department = sub_department;\r\n      this.sub_department_id = sub_department.sub_department_id;\r\n      this.materials = response.data;\r\n      console.log(sub_department);\r\n      this.$vs.notify({\r\n        title:\r\n          this.$t(\"Viewing Department\") +\r\n          \" \" +\r\n          sub_department[\"sub_department_name_\" + this.$i18n.locale],\r\n        text: \"\"\r\n      });\r\n\r\n      this.mode = 2;\r\n    },\r\n    async viewDepartment(department) {\r\n      this.departmentView = 1;\r\n      console.log(department);\r\n      this.department = department;\r\n      this.departmentView = 1;\r\n      const response = await service.postData(\"getMaterialOfficerUsing\", {\r\n        ...this.editObj,\r\n        departmentView: this.departmentView,\r\n        department_id: department.department_id\r\n      });\r\n      this.department_id = department.department_id;\r\n      this.materials = response.data;\r\n      this.$vs.notify({\r\n        title: this.$t(\"Viewing Officer Detail\"),\r\n        text: \"\"\r\n      });\r\n\r\n      this.mode = 2;\r\n    },\r\n    async handleSelected() {\r\n      this.show_detail = true;\r\n      console.log(this.selected);\r\n      this.$vs.notify({\r\n        title: this.$t(\"Viewing \") + this.selected.material_name,\r\n        text: this.$t(\"price \") + this.selected.total_price\r\n      });\r\n      var response = await service.postData(\"getBookingOfficerDetail\", {\r\n        ...this.editObj,\r\n        material_id: this.selected.material_id,\r\n        departmentView: this.departmentView,\r\n        department_id: this.department_id,\r\n        sub_department_id: this.sub_department_id\r\n      });\r\n      this.bookings = response.data;\r\n    },\r\n    async search() {\r\n      this.renderDepartment_chart = false;\r\n\r\n      var response = await service.postData(\"getSummaryDepartmentCost\", {\r\n        ...this.editObj\r\n      });\r\n      this.DepartmentPie.chartOptions.labels = response.data.map(item => {\r\n        return item[\"department_name_\" + this.$i18n.locale];\r\n      });\r\n      this.DepartmentPie.series = response.data.map(item => {\r\n        return parseFloat(item.total_price);\r\n      });\r\n      this.DepartmentPie.analyticsData = [...response.data];\r\n      this.listDepartments = [];\r\n      this.DepartmentPie.analyticsData.forEach(async (item, index) => {\r\n        var test = {\r\n          SubDepartmentPIE: {\r\n            analyticsData: [],\r\n            series: [],\r\n            chartOptions: {\r\n              labels: [],\r\n              dataLabels: {\r\n                enabled: false\r\n              },\r\n              legend: { show: false },\r\n              chart: {\r\n                type: \"pie\",\r\n                offsetY: 30,\r\n                dropShadow: {\r\n                  enabled: false,\r\n                  blur: 5,\r\n                  left: 1,\r\n                  top: 1,\r\n                  opacity: 0.2\r\n                },\r\n                toolbar: {\r\n                  show: false\r\n                }\r\n              },\r\n              stroke: {\r\n                width: 5\r\n              },\r\n              colors: departmentColors[index]\r\n            }\r\n          }\r\n        };\r\n\r\n        var response1 = await service.postData(\"getSummarySubDepartmentCost\", {\r\n          department_id: item.department_id,\r\n          ...this.editObj\r\n        });\r\n        console.log(response1);\r\n        test.SubDepartmentPIE.chartOptions.labels = response1.data.map(\r\n          item1 => {\r\n            return item1[\"sub_department_name_\" + this.$i18n.locale];\r\n          }\r\n        );\r\n        test.SubDepartmentPIE.series = response1.data.map(item1 => {\r\n          return parseFloat(item1.total_price);\r\n        });\r\n        test.SubDepartmentPIE.analyticsData = response1.data;\r\n        // console.log();\r\n        this.listDepartments.push({ ...item, ...test });\r\n      });\r\n      this.renderDepartment_chart = true;\r\n    },\r\n\r\n    async viewOfficer() {\r\n      this.departmentView = 0;\r\n      const response = await service.postData(\"getMaterialOfficerUsing\", {\r\n        ...this.editObj,\r\n        departmentView: this.departmentView,\r\n        department_id: \"\"\r\n      });\r\n      this.materials = response.data;\r\n      this.$vs.notify({\r\n        title: this.$t(\"Viewing Officer Detail\"),\r\n        text: \"\"\r\n      });\r\n\r\n      this.mode = 2;\r\n    },\r\n    notifyClose() {\r\n      this.$vs.notify({\r\n        title: this.$t(\"Backing to Cost Data\"),\r\n        text: \"\"\r\n      });\r\n    }\r\n  }\r\n};\r\n",{"version":3,"sources":["Cost.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cost.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"w-full\">\r\n    <div class=\"mb-base w-full\" v-if=\"mode==1\">\r\n      <vx-card>\r\n        <h6>{{$t(\"Search the code\")}}</h6>\r\n\r\n        <div class=\"mt-6 vx-row mb-6\">\r\n          <div class=\"vx-col lg:w-5/12 md:w-1/2 w-full\">\r\n            <div class=\"vx-row\">\r\n              <div class=\"vx-col lg:w-1/3 w-full mt-5\" style=\"padding-top:3px\">\r\n                <label>{{$t(\"start_datetime\")}}</label>\r\n              </div>\r\n              <div class=\"vx-col lg:w-2/3 w-full lg:mt-5 mt-0 sm:pr-10 lg:pr-0 md:pr-20\">\r\n                <flat-pickr\r\n                  :config=\"configdateTimePicker\"\r\n                  class=\"w-full flatpickr-input\"\r\n                  v-model=\"editObj.start_date\"\r\n                  :class=\"{' danger':invalid.start_date}\"\r\n                  placeholder\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"vx-col lg:w-5/12 md:w-1/2 w-full\">\r\n            <div class=\"vx-row\">\r\n              <div class=\"vx-col lg:w-1/3 w-full mt-5\" style=\"padding-top:3px\">\r\n                <label>{{$t(\"end_datetime\")}}</label>\r\n              </div>\r\n              <div class=\"vx-col lg:w-2/3 w-full lg:mt-5 mt-0 sm:pr-10 lg:pr-0 md:pr-20\">\r\n                <flat-pickr\r\n                  :config=\"configdateTimePicker\"\r\n                  class=\"w-full flatpickr-input\"\r\n                  v-model=\"editObj.end_date\"\r\n                  :class=\"{'w-full flatpickr-input danger':invalid.end_date}\"\r\n                  placeholder\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"vx-col sm:pr-10 md:pr-20 lg:w-1/6 md:w-1/2 w-full mt-5\">\r\n            <div class=\"vx-row pr-4 pl-4\">\r\n              <vs-button\r\n                ref=\"loadableButton\"\r\n                id=\"button-with-loading\"\r\n                class=\"vs-con-loading__container vx-col w-full\"\r\n                vslor=\"primary\"\r\n                @click=\"search()\"\r\n              >{{$t('search')}}</vs-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </vx-card>\r\n      <div class=\"vx-row\">\r\n        <div class=\"vx-col w-full lg:w-1/2 lg:mt-5 mt-base mt-5 overflow-hidden\">\r\n          <vx-card>\r\n            <div slot=\"no-body\">\r\n              <div class=\"vx-card__header\">\r\n                <div class=\"vx-card__title\">\r\n                  <h4 class>{{$t('Officer')}}</h4>\r\n                </div>\r\n                <div class=\"vx-card__actions\">\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"vs-con-dropdown parent-dropdown cursor-pointer\"\r\n                    @click=\"viewOfficer()\"\r\n                  >{{$t('view detail')}}</button>\r\n                </div>\r\n              </div>\r\n              <!-- CHART -->\r\n              <vue-apex-charts\r\n                type=\"pie\"\r\n                height=\"345\"\r\n                class=\"mt-2\"\r\n                :options=\"DepartmentPie.chartOptions\"\r\n                :series=\"DepartmentPie.series\"\r\n                v-if=\"renderDepartment_chart\"\r\n              />\r\n\r\n              <!-- CHART DATA -->\r\n              <div style=\"height:200px;\">\r\n                <VuePerfectScrollbar\r\n                  ref=\"chatLogPS\"\r\n                  class=\"scroll-area pt-6 px-6\"\r\n                  :settings=\"settings\"\r\n                >\r\n                  <ul class=\"mb-1\" ref=\"chatLog\">\r\n                    <li\r\n                      v-for=\"(department,index) in DepartmentPie.analyticsData\"\r\n                      :key=\"index\"\r\n                      class=\"flex justify-between py-3 px-6 border d-theme-border-grey-light border-solid border-r-0 border-l-0 border-b-0\"\r\n                    >\r\n                      <span class=\"flex items-center\">\r\n                        <span\r\n                          class=\"inline-block h-3 w-3 rounded-full mr-2\"\r\n                          :style=\"{'background':colors[index]}\"\r\n                        ></span>\r\n                        <span\r\n                          class=\"font-semibold\"\r\n                        >{{$t('Officer of') +' '+department['department_name_'+$i18n.locale] }}</span>\r\n                      </span>\r\n                      <span>{{ department.total_price }}</span>\r\n                    </li>\r\n                  </ul>\r\n                </VuePerfectScrollbar>\r\n              </div>\r\n            </div>\r\n          </vx-card>\r\n        </div>\r\n\r\n        <div\r\n          class=\"vx-col w-full lg:w-1/2 lg:mt-5 mt-base overflow-hidden\"\r\n          v-for=\"(department,index) in listDepartments\"\r\n          :key=\"index\"\r\n        >\r\n          <vx-card>\r\n            <div slot=\"no-body\">\r\n              <div class=\"vx-card__header\">\r\n                <div class=\"vx-card__title\">\r\n                  <h4 class>{{$t('Officer of') + \" \"+department['department_name_'+$i18n.locale]}}</h4>\r\n                </div>\r\n                <div class=\"vx-card__actions\">\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"vs-con-dropdown parent-dropdown cursor-pointer\"\r\n                    @click=\"viewDepartment(department)\"\r\n                  >{{$t('view detail')}}</button>\r\n                </div>\r\n              </div>\r\n              <!-- CHART -->\r\n              <vue-apex-charts\r\n                type=\"pie\"\r\n                height=\"345\"\r\n                class=\"mt-2\"\r\n                :options=\"department.SubDepartmentPIE.chartOptions\"\r\n                :series=\"department.SubDepartmentPIE.series\"\r\n                v-if=\"renderDepartment_chart\"\r\n              />\r\n              <!-- <pre>{{department | json}}</pre> -->\r\n              <div style=\"height:200px;\">\r\n                <VuePerfectScrollbar\r\n                  ref=\"chatLogPS\"\r\n                  class=\"scroll-area pt-6 px-6\"\r\n                  :settings=\"settings\"\r\n                >\r\n                  <ul class=\"mb-1\" ref=\"chatLog\">\r\n                    <li\r\n                      v-for=\"(sub_department,index1) in department.SubDepartmentPIE.analyticsData\"\r\n                      :key=\"index1\"\r\n                      class=\"flex justify-between py-3 px-6 border d-theme-border-grey-light border-solid border-r-0 border-l-0 border-b-0 sub_department_list\"\r\n                      @click=\"viewSubDepartment(sub_department)\"\r\n                    >\r\n                      <span class=\"flex items-center\">\r\n                        <span\r\n                          class=\"inline-block h-3 w-3 rounded-full mr-2\"\r\n                          :style=\"{'background':departmentColors[index%departmentColors.length][index1]}\"\r\n                        ></span>\r\n                        <span\r\n                          class=\"font-semibold\"\r\n                        >{{ $t('Department of')+' '+sub_department['sub_department_name_'+$i18n.locale]}}</span>\r\n                      </span>\r\n                      <span>{{ sub_department.total_price }}</span>\r\n                    </li>\r\n                  </ul>\r\n                </VuePerfectScrollbar>\r\n              </div>\r\n            </div>\r\n          </vx-card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"mb-base w-full\" v-if=\"mode==2\">\r\n      <div class=\"vx-row mb-5\">\r\n        <vs-button\r\n          class=\"ml-5\"\r\n          vsclor=\"primary\"\r\n          @click=\"mode=1;selected={};materials=[];show_detail=false;notifyClose();\"\r\n        >{{$t('back')}}</vs-button>\r\n        <h5 class=\"mt-3 ml-5\">{{$t('Material Detail')}}</h5>\r\n      </div>\r\n      <vx-card>\r\n        <!-- <pre>{{x}}</pre> -->\r\n        <h3\r\n          v-if=\"sub_department_id==1\"\r\n        >{{ $t('Department of')+' '+sub_department['sub_department_name_'+$i18n.locale]}}</h3>\r\n        <h3\r\n          v-if=\"sub_department_id==0\"\r\n        >{{$t('Officer of') + \" \"+department['department_name_'+$i18n.locale]}}</h3>\r\n        <vs-table\r\n          pagination\r\n          max-items=\"10\"\r\n          v-model=\"selected\"\r\n          @selected=\"handleSelected\"\r\n          search\r\n          :data=\"materials\"\r\n        >\r\n          <template slot=\"thead\">\r\n            <vs-th sort-key=\"material_id\">{{$t('material_id')}}</vs-th>\r\n            <vs-th sort-key=\"material_name\">{{$t('material_name')}}</vs-th>\r\n            <vs-th sort-key=\"material_price\">{{$t('material_price')}}</vs-th>\r\n\r\n            <vs-th sort-key=\"material_number\">{{$t(\"material_number\")}}</vs-th>\r\n            <vs-th sort-key=\"total_price\">{{$t(\"total_price\")}}</vs-th>\r\n          </template>\r\n\r\n          <template slot-scope=\"{data}\">\r\n            <vs-tr :data=\"tr\" :key=\"index\" v-for=\"(tr, index) in data\">\r\n              <vs-td :data=\"tr.material_id\">{{tr.material_id}}</vs-td>\r\n\r\n              <vs-td :data=\"tr.material_name\">{{ tr.material_name}}</vs-td>\r\n              <vs-td :data=\"tr.material_price\">{{tr.material_price}}</vs-td>\r\n              <vs-td :data=\"tr.material_number\">{{tr.material_number}}</vs-td>\r\n              <vs-td :data=\"tr.total_price\">{{tr.total_price}}</vs-td>\r\n            </vs-tr>\r\n          </template>\r\n        </vs-table>\r\n      </vx-card>\r\n      <vx-card class=\"mt-5\" v-if=\"show_detail\">\r\n        <!-- <pre>{{x}}</pre> -->\r\n        <h4 class=\"ml-5\">{{$t('Booking Detail')}}</h4>\r\n        <vs-table stripe pagination max-items=\"10\" search :data=\"bookings\">\r\n          <template slot=\"thead\">\r\n            <vs-th sort-key=\"booking_id\">{{$t('booking_id')}}</vs-th>\r\n\r\n            <vs-th sort-key=\"first_name+last_name\">{{$t(\"first_surname\")}}</vs-th>\r\n            <vs-th sort-key=\"room_name\">{{$t('room_name')}}</vs-th>\r\n            <vs-th sort-key=\"booking_description\">{{$t('booking_description')}}</vs-th>\r\n            <vs-th sort-key=\"start_date\">{{$t('start_date')}}</vs-th>\r\n            <vs-th sort-key=\"end_date\">{{$t('end_date')}}</vs-th>\r\n            <vs-th sort-key=\"status_name\">{{$t('status_name')}}</vs-th>\r\n            <vs-th>{{$t('view')}}</vs-th>\r\n          </template>\r\n\r\n          <template slot-scope=\"{data}\">\r\n            <vs-tr :data=\"tr\" :key=\"index\" v-for=\"(tr, index) in data\">\r\n              <vs-td :data=\"tr.booking_id\">{{ tr.booking_id}}</vs-td>\r\n              <vs-td\r\n                :data=\"tr.first_name+tr.last_name\"\r\n                width=\"200px\"\r\n              >{{tr.first_name+' '+tr.last_name}}</vs-td>\r\n\r\n              <vs-td :data=\"tr.room_name\">{{ tr.room_name}}</vs-td>\r\n              <vs-td :data=\"tr.booking_description\">{{ tr.booking_description}}</vs-td>\r\n              <vs-td :data=\"tr.start_date\">{{ tr.start_date | formatDate}}</vs-td>\r\n              <vs-td :data=\"tr.end_date\">{{ tr.end_date | formatDate}}</vs-td>\r\n\r\n              <vs-td :data=\"tr.status_name\" :class=\"'A'+tr.status_id\">{{ $t(tr.status_name)}}</vs-td>\r\n              <vs-td>\r\n                <feather-icon\r\n                  icon=\"MaximizeIcon\"\r\n                  class=\"cursor-pointer w-6 h-6 text-primary\"\r\n                  size=\"small\"\r\n                  @click=\"views(tr)\"\r\n                ></feather-icon>\r\n              </vs-td>\r\n            </vs-tr>\r\n          </template>\r\n        </vs-table>\r\n        <vs-popup class=\"holamundo\" :title=\"$t('view')\" :active.sync=\"popupActive\">\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('Officer')}}:</div>\r\n            <div class=\"vx-col md:w-3/4 w-1/2 pl-5 value\">{{view['department_name_'+$i18n.locale]}}</div>\r\n          </div>\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('Department')}}:</div>\r\n            <div\r\n              class=\"vx-col md:w-3/4 w-1/2 pl-5 value\"\r\n            >{{view['sub_department_name_'+$i18n.locale]}}</div>\r\n          </div>\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('booking_description')}}:</div>\r\n            <div class=\"vx-col md:w-3/4 w-1/2 pl-5 value\">{{view.booking_description}}</div>\r\n          </div>\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('booking_id')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.booking_id}}</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('first_surname')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.first_name+' '+view.last_name}}</div>\r\n          </div>\r\n\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('room_name')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.room_name}}</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('importance')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{$t(view.important)}}</div>\r\n          </div>\r\n\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('Remark')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.remark}}</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('Tel')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.tel}}</div>\r\n          </div>\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('Member')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.member}}</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('booking_date')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.booking_date | onlyDate}}</div>\r\n          </div>\r\n          <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('date')}}:</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5 value\">{{view.start_date | onlyDate}}</div>\r\n            <div class=\"vx-col md:w-1/4 w-1/2 pl-5\">{{$t('time')}}:</div>\r\n            <div\r\n              class=\"vx-col md:w-1/4 w-1/2 pl-5 value\"\r\n            >{{view.start_date | onlyTime}}-{{view.end_date | onlyTime}}</div>\r\n          </div>\r\n          <v-template v-if=\"materials.length>0\">\r\n            <div class=\"vx-row mt-5 ml-5\">\r\n              <strong>{{$t('Material Detail')}}</strong>\r\n            </div>\r\n            <vs-table stripe pagination max-items=\"10\" search :data=\"material1\">\r\n              <template slot=\"thead\">\r\n                <vs-th sort-key=\"material_id\">{{$t('material_id')}}</vs-th>\r\n\r\n                <vs-th sort-key=\"material_name\">{{$t(\"material_name\")}}</vs-th>\r\n                <vs-th sort-key=\"material_price\">{{$t('material_price')}}</vs-th>\r\n                <vs-th sort-key=\"number\">{{$t('material_number')}}</vs-th>\r\n                <vs-th sort-key=\"total_price\">{{$t('total_price')}}</vs-th>\r\n              </template>\r\n\r\n              <template slot-scope=\"{data}\">\r\n                <vs-tr :data=\"tr\" :key=\"index\" v-for=\"(tr, index) in data\">\r\n                  <vs-td :data=\"tr.material_id\">{{ tr.material_id}}</vs-td>\r\n                  <vs-td :data=\"tr.material_name\" width=\"200px\">{{tr.material_name}}</vs-td>\r\n\r\n                  <vs-td :data=\"tr.material_price\">{{ tr.material_price}}</vs-td>\r\n                  <vs-td :data=\"tr.number\">{{ tr.number}}</vs-td>\r\n                  <vs-td :data=\"tr.total_price\">{{ tr.total_price}}</vs-td>\r\n                </vs-tr>\r\n              </template>\r\n            </vs-table>\r\n          </v-template>\r\n        </vs-popup>\r\n      </vx-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport VueApexCharts from \"vue-apexcharts\";\r\nimport VuePerfectScrollbar from \"vue-perfect-scrollbar\";\r\nimport service from \"@/service/service\";\r\nimport flatPickr from \"vue-flatpickr-component\";\r\nimport \"flatpickr/dist/flatpickr.css\";\r\nimport { async } from \"q\";\r\nimport { departmentColors } from \"./Colors\";\r\nconst colors = [\r\n  \"#242145\",\r\n  \"#03a9f4\",\r\n  \"#b2b63d\",\r\n  \"#ffeb3b\",\r\n  \"#795548\",\r\n  \"#46c93a\",\r\n  \"#1f74ff\",\r\n  \"#ff4757\",\r\n  \"#ffba00\",\r\n  \"#1e1e1e\",\r\n  \"#5b3dc3\",\r\n  \"#17c964\",\r\n  \"#f2135d\",\r\n  \"#ff8200\"\r\n];\r\n\r\nexport default {\r\n  components: {\r\n    VueApexCharts,\r\n    VuePerfectScrollbar,\r\n    flatPickr\r\n  },\r\n  data() {\r\n    return {\r\n      department_id: \"\",\r\n      departmentView: 0,\r\n      popupActive: false,\r\n      selected: {},\r\n      material1: [],\r\n      materials: [],\r\n      deparment: {},\r\n      bookings: [],\r\n      view: {},\r\n      show_detail: false,\r\n      mode: 1,\r\n      sub_department: {},\r\n      departmentColors: departmentColors,\r\n      colors: colors,\r\n      renderDepartment_chart: false,\r\n      settings: {\r\n        // perfectscrollbar settings\r\n        maxScrollbarLength: 60,\r\n        wheelSpeed: 0.6\r\n      },\r\n      configdateTimePicker: {\r\n        enableTime: false,\r\n        enableSeconds: false,\r\n        noCalendar: false\r\n      },\r\n      editObj: {\r\n        start_date: \"\",\r\n        end_date: \"\"\r\n      },\r\n      DepartmentPie: {\r\n        analyticsData: [],\r\n        series: [],\r\n        chartOptions: {\r\n          labels: [],\r\n          dataLabels: {\r\n            enabled: false\r\n          },\r\n          legend: { show: false },\r\n          chart: {\r\n            type: \"pie\",\r\n            offsetY: 30,\r\n            dropShadow: {\r\n              enabled: false,\r\n              blur: 5,\r\n              left: 1,\r\n              top: 1,\r\n              opacity: 0.2\r\n            },\r\n            toolbar: {\r\n              show: false\r\n            }\r\n          },\r\n          stroke: {\r\n            width: 5\r\n          },\r\n          colors: colors\r\n        }\r\n      },\r\n      listDepartments: []\r\n    };\r\n  },\r\n  computed: {\r\n    invalid() {\r\n      var require = type => this.submitted && this.editObj[type] == \"\";\r\n      return {\r\n        start_date: require(\"start_date\"),\r\n        end_date: require(\"end_date\")\r\n      };\r\n    },\r\n    isInvald() {\r\n      return this.invalid.start_date || this.invalid.end_date;\r\n    },\r\n    isSelected() {\r\n      return JSON.stringify(this.selected) == \"{}\";\r\n    }\r\n  },\r\n\r\n  async mounted() {\r\n    this.$refs.chatLogPS.$el.scrollTop = 0;\r\n    this.search();\r\n  },\r\n  methods: {\r\n    views(tr) {\r\n      this.popupActive = true;\r\n      this.view = tr;\r\n      service\r\n        .postData(\"/get_booked_material\", { booking_id: tr.booking_id })\r\n        .then(result => {\r\n          this.material1 = result.data;\r\n        });\r\n    },\r\n    async viewSubDepartment(sub_department) {\r\n      const response = await service.postData(\"getMaterialOfficerUsing\", {\r\n        ...this.editObj,\r\n        sub_departmentView: 1,\r\n        sub_department_id: sub_department.sub_department_id\r\n      });\r\n      this.departmentView = 0;\r\n      this.sub_department = sub_department;\r\n      this.sub_department_id = sub_department.sub_department_id;\r\n      this.materials = response.data;\r\n      console.log(sub_department);\r\n      this.$vs.notify({\r\n        title:\r\n          this.$t(\"Viewing Department\") +\r\n          \" \" +\r\n          sub_department[\"sub_department_name_\" + this.$i18n.locale],\r\n        text: \"\"\r\n      });\r\n\r\n      this.mode = 2;\r\n    },\r\n    async viewDepartment(department) {\r\n      this.departmentView = 1;\r\n      console.log(department);\r\n      this.department = department;\r\n      this.departmentView = 1;\r\n      const response = await service.postData(\"getMaterialOfficerUsing\", {\r\n        ...this.editObj,\r\n        departmentView: this.departmentView,\r\n        department_id: department.department_id\r\n      });\r\n      this.department_id = department.department_id;\r\n      this.materials = response.data;\r\n      this.$vs.notify({\r\n        title: this.$t(\"Viewing Officer Detail\"),\r\n        text: \"\"\r\n      });\r\n\r\n      this.mode = 2;\r\n    },\r\n    async handleSelected() {\r\n      this.show_detail = true;\r\n      console.log(this.selected);\r\n      this.$vs.notify({\r\n        title: this.$t(\"Viewing \") + this.selected.material_name,\r\n        text: this.$t(\"price \") + this.selected.total_price\r\n      });\r\n      var response = await service.postData(\"getBookingOfficerDetail\", {\r\n        ...this.editObj,\r\n        material_id: this.selected.material_id,\r\n        departmentView: this.departmentView,\r\n        department_id: this.department_id,\r\n        sub_department_id: this.sub_department_id\r\n      });\r\n      this.bookings = response.data;\r\n    },\r\n    async search() {\r\n      this.renderDepartment_chart = false;\r\n\r\n      var response = await service.postData(\"getSummaryDepartmentCost\", {\r\n        ...this.editObj\r\n      });\r\n      this.DepartmentPie.chartOptions.labels = response.data.map(item => {\r\n        return item[\"department_name_\" + this.$i18n.locale];\r\n      });\r\n      this.DepartmentPie.series = response.data.map(item => {\r\n        return parseFloat(item.total_price);\r\n      });\r\n      this.DepartmentPie.analyticsData = [...response.data];\r\n      this.listDepartments = [];\r\n      this.DepartmentPie.analyticsData.forEach(async (item, index) => {\r\n        var test = {\r\n          SubDepartmentPIE: {\r\n            analyticsData: [],\r\n            series: [],\r\n            chartOptions: {\r\n              labels: [],\r\n              dataLabels: {\r\n                enabled: false\r\n              },\r\n              legend: { show: false },\r\n              chart: {\r\n                type: \"pie\",\r\n                offsetY: 30,\r\n                dropShadow: {\r\n                  enabled: false,\r\n                  blur: 5,\r\n                  left: 1,\r\n                  top: 1,\r\n                  opacity: 0.2\r\n                },\r\n                toolbar: {\r\n                  show: false\r\n                }\r\n              },\r\n              stroke: {\r\n                width: 5\r\n              },\r\n              colors: departmentColors[index]\r\n            }\r\n          }\r\n        };\r\n\r\n        var response1 = await service.postData(\"getSummarySubDepartmentCost\", {\r\n          department_id: item.department_id,\r\n          ...this.editObj\r\n        });\r\n        console.log(response1);\r\n        test.SubDepartmentPIE.chartOptions.labels = response1.data.map(\r\n          item1 => {\r\n            return item1[\"sub_department_name_\" + this.$i18n.locale];\r\n          }\r\n        );\r\n        test.SubDepartmentPIE.series = response1.data.map(item1 => {\r\n          return parseFloat(item1.total_price);\r\n        });\r\n        test.SubDepartmentPIE.analyticsData = response1.data;\r\n        // console.log();\r\n        this.listDepartments.push({ ...item, ...test });\r\n      });\r\n      this.renderDepartment_chart = true;\r\n    },\r\n\r\n    async viewOfficer() {\r\n      this.departmentView = 0;\r\n      const response = await service.postData(\"getMaterialOfficerUsing\", {\r\n        ...this.editObj,\r\n        departmentView: this.departmentView,\r\n        department_id: \"\"\r\n      });\r\n      this.materials = response.data;\r\n      this.$vs.notify({\r\n        title: this.$t(\"Viewing Officer Detail\"),\r\n        text: \"\"\r\n      });\r\n\r\n      this.mode = 2;\r\n    },\r\n    notifyClose() {\r\n      this.$vs.notify({\r\n        title: this.$t(\"Backing to Cost Data\"),\r\n        text: \"\"\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.sub_department_list {\r\n  cursor: pointer;\r\n}\r\n.sub_department_list:hover {\r\n  background: #03a9f4;\r\n  color: white;\r\n}\r\n</style>\r\n"]}]}