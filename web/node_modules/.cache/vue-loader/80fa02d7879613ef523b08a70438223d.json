{"remainingRequest":"D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DTC PROJECT\\booking\\web\\src\\views\\book_room.vue?vue&type=style&index=0&id=7169a498&lang=scss&scoped=true&","dependencies":[{"path":"D:\\DTC PROJECT\\booking\\web\\src\\views\\book_room.vue","mtime":1575335762792},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\css-loader\\index.js","mtime":1567052517015},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.right{\n  float:right;\n  margin-right:10px;\n}\n.require{\n  color: red;\n}\n\n.danger input {\n  padding: .7rem;\n  font-size: 1rem;\n  border-radius: 5px;\n  border: 1px solid red;\n  color: #626262;\n  width: 100%;\n}\n .error{\n  color:red;\n   font-size:80%;\n}\ntd{\n  width:50%;\n  padding: 10px;\n}\ntr td:first-child{\n  padding-left:30px;\n}\n\n\n",{"version":3,"sources":["book_room.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8LA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"book_room.vue","sourceRoot":"src/views","sourcesContent":["<template >\r\n  <div class=\"vx-col w-full mb-base\" v-if=\"renderComponent\">\r\n\r\n    <div class=\"w-full\" v-if=\"!booking\">\r\n      <vx-card>\r\n      <h6>{{$t(\"search_free_room\")}}</h6>\r\n\r\n      <div class=\"mt-6 vx-row mb-6\">\r\n        <div class=\"vx-col md:w-1/4\">\r\n          <label>{{$t(\"room\")}}</label>\r\n          <vs-select class=\"w-full\" v-model=\"editObj.room_id\" >\r\n                <vs-select-item value='' :text=\"$t('all')\"/>\r\n                <vs-select-item :key=\"index\" :value=\"item.room_id\" :text=\"$t(item.room_name)\" v-for=\"(item,index) in rooms\" />\r\n            </vs-select>\r\n        </div>\r\n        <div class=\"vx-col md:w-1/4\">\r\n          <label>{{$t(\"date\")}}</label>\r\n          <flat-pickr :config=\"configdateTimePicker\" class=\"w-full\" v-model=\"editObj.date\" placeholder=\"Choose time\" />\r\n        </div>\r\n\r\n        <div class=\"vx-col md:w-1/3\">\r\n          <div style=\"width:45%;float:left\">\r\n              <label>{{$t(\"time\")}}</label>\r\n              <flat-pickr :config=\"configTime\" class=\"w-full\" v-model=\"editObj.start_time\" placeholder=\"Choose time\" />\r\n          </div>\r\n\r\n          <div style=\"width:10%;float:left;text-align:center;padding-top:30px\">{{$t('to')}}</div>\r\n          <div style=\"width:45%;padding-top:20px;float:left\">\r\n\r\n            <flat-pickr :config=\"configTime\" class=\"w-full\" v-model=\"editObj.end_time\" placeholder=\"Choose time\" />\r\n          </div>\r\n        </div>\r\n        <div class=\"vx-col md:w-1/6\" style=\"padding-top:20px;\">\r\n          <vs-button ref=\"loadableButton\" id=\"button-with-loading\" class=\"vs-con-loading__container right\" vslor=\"primary\" @click=\"search()\">{{$t('search')}}</vs-button>\r\n        </div>\r\n\r\n        <!-- <div class=\"vx-col md:w-1/2\">\r\n          <label>{{$t(\"start_date\")}}</label>\r\n          <datepicker format=\"yyyy-MM-dd\" v-model=\"editObj.start_date\" style=\"width:100%\" class=\"w-full\"></datepicker>\r\n        </div>\r\n        <div class=\"vx-col md:w-1/2\">\r\n          <label>{{$t(\"start_date\")}}</label>\r\n          <datepicker format=\"yyyy-MM-dd\" v-model=\"editObj.start_date\" style=\"width:100%\" class=\"w-full\"></datepicker>\r\n        </div>\r\n        <div class=\"vx-col md:w-1/4\">\r\n          <label>{{$t(\"start_date\")}}</label>\r\n          <datepicker format=\"yyyy-MM-dd\" v-model=\"editObj.start_date\" style=\"width:100%\" class=\"w-full\"></datepicker>\r\n        </div>\r\n        <div class=\"vx-col md:w-1/4\">\r\n          <label>{{$t(\"start_date\")}}</label>\r\n          <datepicker format=\"yyyy-MM-dd\" v-model=\"editObj.start_date\" style=\"width:100%\" class=\"w-full\"></datepicker>\r\n        </div> -->\r\n      </div>\r\n\r\n    </vx-card>\r\n    <div class=\"mt-6 text-center\" v-if=\"room_lists.length==0&&searched\">\r\n        {{$t(\"no_data\")}}\r\n    </div>\r\n     <div class=\"vx-row\">\r\n    <div  v-for=\"(item,index) in room_lists\" :key=\"index\" class=\"vx-col md:w-1/3 mt-5\" style=\"padding:10px\">\r\n      <vx-card class=\"w-full\">\r\n            <table style=\"width:100%\">\r\n                <tr>\r\n                  <td>{{$t(\"room_id\")}}</td><td>{{item.room_id}}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>{{$t(\"room_name\")}}</td><td>{{item.room_name}}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>{{$t(\"num_table\")}}</td><td>{{item.num_table}}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>{{$t(\"num_chair\")}} </td><td>{{item.num_chair}}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>{{$t(\"status\")}}</td><td :style=\"{color:item.status=='1'?'green':'red'}\">{{item.status=='1'?$t('Available'):$t('Not Available')}}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td colspan=\"2\"> <vs-button ref=\"loadableButton\" id=\"button-with-loading1\" class=\"vs-con-loading__container\" vslor=\"primary\" @click=\"book(item)\" :disabled=\"item.status=='0'\">{{$t('book_this_room')}}</vs-button></td>\r\n                </tr>\r\n            </table>\r\n\r\n\r\n\r\n    </vx-card>\r\n    </div>\r\n\r\n      </div>\r\n    </div>\r\n    <div class=\"w-full\" v-if=\"booking\">\r\n      <vx-card>\r\n          <div class=\"vx-row\">\r\n            <div class=\"vx-col full\">\r\n              <h6>{{$t('booking_room')}}</h6>\r\n            </div>\r\n          </div>\r\n          <div class=\"mt-6 vx-row ml-10 mr-10\">\r\n              <div class=\"vx-col md:w-1/2\">\r\n                  <table style=\"width:100%\">\r\n                    <tr>\r\n                      <td style=\"padding:5px\">{{$t(\"username\")}}</td>\r\n                      <td class=\"text-primary\">{{booking_data.first_name+' '+booking_data.last_name}}</td>\r\n\r\n                    </tr>\r\n                    <tr></tr>\r\n                    <tr style=\"\">\r\n                      <td style=\"padding:5px\">{{$t('start_date')}}</td>\r\n                      <td class=\"text-primary\">{{booking_data.start_date}}</td>\r\n\r\n                    </tr>\r\n                  </table>\r\n              </div>\r\n              <div class=\"vx-col md:w-1/2\">\r\n                  <table style=\"width:100%\">\r\n                    <tr>\r\n\r\n                      <td>{{$t(\"room_name\")}}</td>\r\n                      <td class=\"text-primary\">{{booking_data.room_name}}</td>\r\n                    </tr>\r\n                    <tr></tr>\r\n                    <tr style=\"\">\r\n\r\n                      <td >{{$t('end_date')}}</td>\r\n                      <td class=\"text-primary\">{{booking_data.end_date}}</td>\r\n                    </tr>\r\n                  </table>\r\n              </div>\r\n          </div>\r\n          <vs-divider position=\"left\"> {{$t(\"detail_input\")}} </vs-divider>\r\n          <div class=\"vx-row\">\r\n            <div class=\"vx-col md:w-1/4\" style=\"text-align:right\">\r\n              {{$t(\"detail\")}}\r\n            </div>\r\n            <div class=\"vx-col md:w-1/2\">\r\n              <vs-input class=\"w-full\" v-model=\"detail\" />\r\n            </div>\r\n\r\n          </div>\r\n\r\n          <vs-divider position=\"left\"> {{$t(\"material_using\")}} </vs-divider>\r\n          <div class=\"vx-row\" v-for=\"(item,index) in material_lists\" :key=\"index\">\r\n            <div class=\"vx-col md:w-1/4\" style=\"text-align:right\">\r\n\r\n            </div>\r\n            <div class=\"vx-col md:w-1/4\">\r\n              {{$t(\"material\")}} ({{$t('material_price')}})\r\n              <vs-select class=\"w-full\" v-model=\"item.material_id\">\r\n                          <vs-select-item :key=\"index\" :value=\"material.material_id\" :text=\"$t(material.material_name+' ('+material.material_price+')')\" v-for=\"(material,index) in materials\" />\r\n               </vs-select>\r\n            </div>\r\n            <div class=\"vx-col md:w-1/4\">\r\n              {{$t(\"material_number\")}}\r\n               <vs-input class=\"w-full\" v-model=\"item.material_number\"  onkeypress='checkNumber(event)' />\r\n            </div>\r\n            <div class=\"vx-col md:w-1/4 mt-5\">\r\n              <vs-button ref=\"loadableButton\"  color=\"danger\" @click=\"material_lists.splice(index,1)\"> {{$t('remove')}}</vs-button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"vx-row\">\r\n            <div class=\"vx-col md:w-1/4\" style=\"text-align:right\">\r\n\r\n            </div>\r\n            <div class=\"vx-col md:w-1/4\">\r\n              {{$t(\"material\")}} ({{$t('material_price')}})\r\n              <vs-select class=\"w-full\" v-model=\"material.material_id\">\r\n                          <vs-select-item :key=\"index\" :value=\"item.material_id\" :text=\"$t(item.material_name+ '('+item.material_price+')')\" v-for=\"(item,index) in materials\" />\r\n               </vs-select>\r\n            </div>\r\n            <div class=\"vx-col md:w-1/4\">\r\n              {{$t(\"material_number\")}}\r\n               <vs-input class=\"w-full\" v-model=\"material.material_number\" onkeypress='checkNumber(event)' />\r\n            </div>\r\n            <div class=\"vx-col md:w-1/4 mt-5\">\r\n              <vs-button ref=\"loadableButton\"  vslor=\"primary\" @click=\"add()\">{{$t('add')}}</vs-button>\r\n            </div>\r\n          </div>\r\n          <div class=\"vx-row mt-10\">\r\n            <div class=\"w-full\">\r\n              <vs-button class=\"right\" color=\"danger\" type=\"border\" @click=\"booking=false;booking_data={}\">{{$t('cancel')}}</vs-button>\r\n              <vs-button class=\"right\" @click=\"save()\">{{$t('save')}}</vs-button>\r\n            </div>\r\n          </div>\r\n      </vx-card>\r\n\r\n    </div>\r\n  </div>\r\n  <!-- <button>click</button> -->\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n  .right{\r\n    float:right;\r\n    margin-right:10px;\r\n  }\r\n  .require{\r\n    color: red;\r\n  }\r\n\r\n  .danger input {\r\n    padding: .7rem;\r\n    font-size: 1rem;\r\n    border-radius: 5px;\r\n    border: 1px solid red;\r\n    color: #626262;\r\n    width: 100%;\r\n  }\r\n   .error{\r\n    color:red;\r\n     font-size:80%;\r\n  }\r\n  td{\r\n    width:50%;\r\n    padding: 10px;\r\n  }\r\n  tr td:first-child{\r\n    padding-left:30px;\r\n  }\r\n\r\n\r\n</style>\r\n\r\n\r\n<script>\r\nimport Datepicker from 'vuejs-datepicker';\r\nimport service from '@/service/service';\r\n// import ViewData from './view/ViewData.vue';\r\nimport moment from 'moment';\r\n// import firebase from 'firebase/app'à¸§\r\n// import * as firebase from 'firebase/app';\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\n// import '@firebase/messaging';\r\nexport default {\r\n  components: {\r\n    Datepicker,\r\n    flatPickr\r\n  },\r\n   data(){\r\n      return {\r\n        renderComponent:true,\r\n        editObj:{},\r\n        booking:false,\r\n        detail:\"\",\r\n        searched:false,\r\n        rooms:[],\r\n        materials:[],\r\n        booking_data:{},\r\n        material:{},\r\n        material_lists:[],\r\n        configdateTimePicker: {\r\n              enableTime: false,\r\n              enableSeconds: false,\r\n              noCalendar: false\r\n            },\r\n            configTime:{\r\n                enableTime: true,\r\n                enableSeconds: true,\r\n                noCalendar: true\r\n            },\r\n        room_lists:[]\r\n      }\r\n   },\r\n\r\n   computed:{\r\n     body(){\r\n       return {\r\n         room_id:this.editObj.room_id,\r\n         start_date:this.editObj.date+' '+this.editObj.start_time,\r\n          end_date:this.editObj.date+' '+this.editObj.end_time\r\n       }\r\n     }\r\n   },\r\n   created(){\r\n     service.postData(\"material/get\",{}).then((result)=>{\r\n        this.materials=result.data;\r\n     })\r\n     this.material={material_id:\"\",material_number:\"\"}\r\n     this.initVal();\r\n   },\r\n\r\n   methods: {\r\n     initVal(){\r\n       this.editObj={\r\n         room_id:\"\",\r\n         date:moment().format(\"YYYY-MM-DD\"),\r\n         start_time:moment().format(\"HH:mm:ss\"),\r\n         end_time:moment().format(\"HH:mm:ss\")\r\n       }\r\n       this.rooms=service.postData(\"get_room\",{}).then((result)=>{\r\n         this.rooms=result.data;\r\n       })\r\n     },\r\n     search(){\r\n       this.searched=true;\r\n        console.log(\"searching\");\r\n\r\n\r\n       if(!moment(this.body.start_date).isBefore(moment(this.body.end_date))){\r\n         this.$swal(this.$t(\"start_date_canot_more_than_end_date\"),'','error');\r\n       }else{\r\n         this.$vs.loading({\r\n            background: this.backgroundLoading,\r\n            color: this.colorLoading,\r\n            container: \"#button-with-loading\",\r\n            scale: 0.45\r\n          })\r\n         service.postData(\"get_room_with_status\",this.body).then((result)=>{\r\n           this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n           this.room_lists=result.data;\r\n         },err=>{\r\n            this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n         })\r\n       }\r\n     },\r\n     add(){\r\n       this.material_lists.push(this.material);\r\n       this.material={material_id:\"\",material_number:\"\"}\r\n     },\r\n     book(item){\r\n       this.booking=true;\r\n       var {username,first_name,last_name}=service.getUser().user;\r\n       this.booking_data={\r\n         room_id:item.room_id,\r\n         start_date:this.body.start_date,\r\n         end_date:this.body.end_date,\r\n         username:username,\r\n         first_name:first_name,\r\n         last_name:last_name,\r\n         room_name:item.room_name\r\n       }\r\n\r\n     },\r\n     save(){\r\n       var result=[];\r\n       var materials=this.material_lists.map((item)=>item);\r\n       materials.push(this.material);\r\n       materials.filter((item)=>item.material_number!=\"\").reduce(function(res, value) {\r\n          if (!res[value.material_id]) {\r\n            res[value.material_id] = { Id: value.material_id, material_number: 0 };\r\n            result.push(res[value.material_id])\r\n          }\r\n          res[value.material_id].material_number = parseInt(res[value.material_id].material_number)+parseInt(value.material_number);\r\n          return res;\r\n        }, {});\r\n        var material_lists=result.filter((item)=>item.material_number>0);\r\n        console.log(result);\r\n        this.$swal({\r\n          title:this.$t('booking_room_title'),\r\n          type: 'warning',\r\n          showCancelButton: true,\r\n          confirmButtonColor: '#3085d6',\r\n          cancelButtonColor: '#d33',\r\n          cancelButtonText:this.$t('cancel'),\r\n          confirmButtonText:this.$t('book'),\r\n          showLoaderOnConfirm: true,\r\n          preConfirm:()=>{\r\n            var {username,room_id,start_date,end_date}=this.booking_data;\r\n            return  service.postData(\"/booking_room\",{\r\n              booking_description:this.detail,\r\n              username,room_id,start_date,end_date,\r\n              material_lists\r\n            }).then((result)=>{\r\n               return result;\r\n            })\r\n\r\n          }\r\n        }).then((result) => {\r\n          if(result.value){\r\n            if(result.value.code){\r\n                this.$swal(this.$t(\"success_title\"),\"\",\"success\").then((result)=>{\r\n                    this.booking=false;\r\n                     service.postData(\"get_room_with_status\",this.body).then((result)=>{\r\n                        // this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                        this.room_lists=result.data;\r\n                        this.material_lists=[];\r\n                      },err=>{\r\n                          // this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                      })\r\n                });\r\n              }else{\r\n                 this.$swal(result.value.message,'','error')\r\n              }\r\n\r\n          }\r\n        })\r\n     }\r\n   },\r\n  watch: {\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n"]}]}